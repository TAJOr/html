(function(){var ci={669:function(g,C,v){g.exports=v(609)},448:function(g,C,v){"use strict";var _=v(867),f=v(26),O=v(372),p=v(327),E=v(97),w=v(109),m=v(985),S=v(61),R=v(655),A=v(263);g.exports=function(y){return new Promise(function(I,Y){var K=y.data,te=y.headers,pe=y.responseType,de;function ne(){y.cancelToken&&y.cancelToken.unsubscribe(de),y.signal&&y.signal.removeEventListener("abort",de)}_.isFormData(K)&&delete te["Content-Type"];var L=new XMLHttpRequest;if(y.auth){var X=y.auth.username||"",Ee=y.auth.password?unescape(encodeURIComponent(y.auth.password)):"";te.Authorization="Basic "+btoa(X+":"+Ee)}var Pe=E(y.baseURL,y.url);L.open(y.method.toUpperCase(),p(Pe,y.params,y.paramsSerializer),!0),L.timeout=y.timeout;function x(){if(!!L){var ae="getAllResponseHeaders"in L?w(L.getAllResponseHeaders()):null,Se=!pe||pe==="text"||pe==="json"?L.responseText:L.response,re={data:Se,status:L.status,statusText:L.statusText,headers:ae,config:y,request:L};f(function(Et){I(Et),ne()},function(Et){Y(Et),ne()},re),L=null}}if("onloadend"in L?L.onloadend=x:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(x)},L.onabort=function(){!L||(Y(S("Request aborted",y,"ECONNABORTED",L)),L=null)},L.onerror=function(){Y(S("Network Error",y,null,L)),L=null},L.ontimeout=function(){var Se=y.timeout?"timeout of "+y.timeout+"ms exceeded":"timeout exceeded",re=y.transitional||R.transitional;y.timeoutErrorMessage&&(Se=y.timeoutErrorMessage),Y(S(Se,y,re.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",L)),L=null},_.isStandardBrowserEnv()){var oe=(y.withCredentials||m(Pe))&&y.xsrfCookieName?O.read(y.xsrfCookieName):void 0;oe&&(te[y.xsrfHeaderName]=oe)}"setRequestHeader"in L&&_.forEach(te,function(Se,re){typeof K>"u"&&re.toLowerCase()==="content-type"?delete te[re]:L.setRequestHeader(re,Se)}),_.isUndefined(y.withCredentials)||(L.withCredentials=!!y.withCredentials),pe&&pe!=="json"&&(L.responseType=y.responseType),typeof y.onDownloadProgress=="function"&&L.addEventListener("progress",y.onDownloadProgress),typeof y.onUploadProgress=="function"&&L.upload&&L.upload.addEventListener("progress",y.onUploadProgress),(y.cancelToken||y.signal)&&(de=function(ae){!L||(Y(!ae||ae&&ae.type?new A("canceled"):ae),L.abort(),L=null)},y.cancelToken&&y.cancelToken.subscribe(de),y.signal&&(y.signal.aborted?de():y.signal.addEventListener("abort",de))),K||(K=null),L.send(K)})}},609:function(g,C,v){"use strict";var _=v(867),f=v(849),O=v(321),p=v(185),E=v(655);function w(S){var R=new O(S),A=f(O.prototype.request,R);return _.extend(A,O.prototype,R),_.extend(A,R),A.create=function(y){return w(p(S,y))},A}var m=w(E);m.Axios=O,m.Cancel=v(263),m.CancelToken=v(972),m.isCancel=v(502),m.VERSION=v(288).version,m.all=function(R){return Promise.all(R)},m.spread=v(713),m.isAxiosError=v(268),g.exports=m,g.exports.default=m},263:function(g){"use strict";function C(v){this.message=v}C.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},C.prototype.__CANCEL__=!0,g.exports=C},972:function(g,C,v){"use strict";var _=v(263);function f(O){if(typeof O!="function")throw new TypeError("executor must be a function.");var p;this.promise=new Promise(function(m){p=m});var E=this;this.promise.then(function(w){if(!!E._listeners){var m,S=E._listeners.length;for(m=0;m<S;m++)E._listeners[m](w);E._listeners=null}}),this.promise.then=function(w){var m,S=new Promise(function(R){E.subscribe(R),m=R}).then(w);return S.cancel=function(){E.unsubscribe(m)},S},O(function(m){E.reason||(E.reason=new _(m),p(E.reason))})}f.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},f.prototype.subscribe=function(p){if(this.reason){p(this.reason);return}this._listeners?this._listeners.push(p):this._listeners=[p]},f.prototype.unsubscribe=function(p){if(!!this._listeners){var E=this._listeners.indexOf(p);E!==-1&&this._listeners.splice(E,1)}},f.source=function(){var p,E=new f(function(m){p=m});return{token:E,cancel:p}},g.exports=f},502:function(g){"use strict";g.exports=function(v){return!!(v&&v.__CANCEL__)}},321:function(g,C,v){"use strict";var _=v(867),f=v(327),O=v(782),p=v(572),E=v(185),w=v(875),m=w.validators;function S(R){this.defaults=R,this.interceptors={request:new O,response:new O}}S.prototype.request=function(A,k){if(typeof A=="string"?(k=k||{},k.url=A):k=A||{},!k.url)throw new Error("Provided config url is not valid");k=E(this.defaults,k),k.method?k.method=k.method.toLowerCase():this.defaults.method?k.method=this.defaults.method.toLowerCase():k.method="get";var y=k.transitional;y!==void 0&&w.assertOptions(y,{silentJSONParsing:m.transitional(m.boolean),forcedJSONParsing:m.transitional(m.boolean),clarifyTimeoutError:m.transitional(m.boolean)},!1);var M=[],I=!0;this.interceptors.request.forEach(function(X){typeof X.runWhen=="function"&&X.runWhen(k)===!1||(I=I&&X.synchronous,M.unshift(X.fulfilled,X.rejected))});var Y=[];this.interceptors.response.forEach(function(X){Y.push(X.fulfilled,X.rejected)});var K;if(!I){var te=[p,void 0];for(Array.prototype.unshift.apply(te,M),te=te.concat(Y),K=Promise.resolve(k);te.length;)K=K.then(te.shift(),te.shift());return K}for(var pe=k;M.length;){var de=M.shift(),ne=M.shift();try{pe=de(pe)}catch(L){ne(L);break}}try{K=p(pe)}catch(L){return Promise.reject(L)}for(;Y.length;)K=K.then(Y.shift(),Y.shift());return K},S.prototype.getUri=function(A){if(!A.url)throw new Error("Provided config url is not valid");return A=E(this.defaults,A),f(A.url,A.params,A.paramsSerializer).replace(/^\?/,"")},_.forEach(["delete","get","head","options"],function(A){S.prototype[A]=function(k,y){return this.request(E(y||{},{method:A,url:k,data:(y||{}).data}))}}),_.forEach(["post","put","patch"],function(A){S.prototype[A]=function(k,y,M){return this.request(E(M||{},{method:A,url:k,data:y}))}}),g.exports=S},782:function(g,C,v){"use strict";var _=v(867);function f(){this.handlers=[]}f.prototype.use=function(p,E,w){return this.handlers.push({fulfilled:p,rejected:E,synchronous:w?w.synchronous:!1,runWhen:w?w.runWhen:null}),this.handlers.length-1},f.prototype.eject=function(p){this.handlers[p]&&(this.handlers[p]=null)},f.prototype.forEach=function(p){_.forEach(this.handlers,function(w){w!==null&&p(w)})},g.exports=f},97:function(g,C,v){"use strict";var _=v(793),f=v(303);g.exports=function(p,E){return p&&!_(E)?f(p,E):E}},61:function(g,C,v){"use strict";var _=v(481);g.exports=function(O,p,E,w,m){var S=new Error(O);return _(S,p,E,w,m)}},572:function(g,C,v){"use strict";var _=v(867),f=v(527),O=v(502),p=v(655),E=v(263);function w(m){if(m.cancelToken&&m.cancelToken.throwIfRequested(),m.signal&&m.signal.aborted)throw new E("canceled")}g.exports=function(S){w(S),S.headers=S.headers||{},S.data=f.call(S,S.data,S.headers,S.transformRequest),S.headers=_.merge(S.headers.common||{},S.headers[S.method]||{},S.headers),_.forEach(["delete","get","head","post","put","patch","common"],function(k){delete S.headers[k]});var R=S.adapter||p.adapter;return R(S).then(function(k){return w(S),k.data=f.call(S,k.data,k.headers,S.transformResponse),k},function(k){return O(k)||(w(S),k&&k.response&&(k.response.data=f.call(S,k.response.data,k.response.headers,S.transformResponse))),Promise.reject(k)})}},481:function(g){"use strict";g.exports=function(v,_,f,O,p){return v.config=_,f&&(v.code=f),v.request=O,v.response=p,v.isAxiosError=!0,v.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},v}},185:function(g,C,v){"use strict";var _=v(867);g.exports=function(O,p){p=p||{};var E={};function w(y,M){return _.isPlainObject(y)&&_.isPlainObject(M)?_.merge(y,M):_.isPlainObject(M)?_.merge({},M):_.isArray(M)?M.slice():M}function m(y){if(_.isUndefined(p[y])){if(!_.isUndefined(O[y]))return w(void 0,O[y])}else return w(O[y],p[y])}function S(y){if(!_.isUndefined(p[y]))return w(void 0,p[y])}function R(y){if(_.isUndefined(p[y])){if(!_.isUndefined(O[y]))return w(void 0,O[y])}else return w(void 0,p[y])}function A(y){if(y in p)return w(O[y],p[y]);if(y in O)return w(void 0,O[y])}var k={url:S,method:S,data:S,baseURL:R,transformRequest:R,transformResponse:R,paramsSerializer:R,timeout:R,timeoutMessage:R,withCredentials:R,adapter:R,responseType:R,xsrfCookieName:R,xsrfHeaderName:R,onUploadProgress:R,onDownloadProgress:R,decompress:R,maxContentLength:R,maxBodyLength:R,transport:R,httpAgent:R,httpsAgent:R,cancelToken:R,socketPath:R,responseEncoding:R,validateStatus:A};return _.forEach(Object.keys(O).concat(Object.keys(p)),function(M){var I=k[M]||m,Y=I(M);_.isUndefined(Y)&&I!==A||(E[M]=Y)}),E}},26:function(g,C,v){"use strict";var _=v(61);g.exports=function(O,p,E){var w=E.config.validateStatus;!E.status||!w||w(E.status)?O(E):p(_("Request failed with status code "+E.status,E.config,null,E.request,E))}},527:function(g,C,v){"use strict";var _=v(867),f=v(655);g.exports=function(p,E,w){var m=this||f;return _.forEach(w,function(R){p=R.call(m,p,E)}),p}},655:function(g,C,v){"use strict";var _=v(155),f=v(867),O=v(16),p=v(481),E={"Content-Type":"application/x-www-form-urlencoded"};function w(A,k){!f.isUndefined(A)&&f.isUndefined(A["Content-Type"])&&(A["Content-Type"]=k)}function m(){var A;return(typeof XMLHttpRequest<"u"||typeof _<"u"&&Object.prototype.toString.call(_)==="[object process]")&&(A=v(448)),A}function S(A,k,y){if(f.isString(A))try{return(k||JSON.parse)(A),f.trim(A)}catch(M){if(M.name!=="SyntaxError")throw M}return(y||JSON.stringify)(A)}var R={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:m(),transformRequest:[function(k,y){return O(y,"Accept"),O(y,"Content-Type"),f.isFormData(k)||f.isArrayBuffer(k)||f.isBuffer(k)||f.isStream(k)||f.isFile(k)||f.isBlob(k)?k:f.isArrayBufferView(k)?k.buffer:f.isURLSearchParams(k)?(w(y,"application/x-www-form-urlencoded;charset=utf-8"),k.toString()):f.isObject(k)||y&&y["Content-Type"]==="application/json"?(w(y,"application/json"),S(k)):k}],transformResponse:[function(k){var y=this.transitional||R.transitional,M=y&&y.silentJSONParsing,I=y&&y.forcedJSONParsing,Y=!M&&this.responseType==="json";if(Y||I&&f.isString(k)&&k.length)try{return JSON.parse(k)}catch(K){if(Y)throw K.name==="SyntaxError"?p(K,this,"E_JSON_PARSE"):K}return k}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(k){return k>=200&&k<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};f.forEach(["delete","get","head"],function(k){R.headers[k]={}}),f.forEach(["post","put","patch"],function(k){R.headers[k]=f.merge(E)}),g.exports=R},288:function(g){g.exports={version:"0.25.0"}},849:function(g){"use strict";g.exports=function(v,_){return function(){for(var O=new Array(arguments.length),p=0;p<O.length;p++)O[p]=arguments[p];return v.apply(_,O)}}},327:function(g,C,v){"use strict";var _=v(867);function f(O){return encodeURIComponent(O).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}g.exports=function(p,E,w){if(!E)return p;var m;if(w)m=w(E);else if(_.isURLSearchParams(E))m=E.toString();else{var S=[];_.forEach(E,function(k,y){k===null||typeof k>"u"||(_.isArray(k)?y=y+"[]":k=[k],_.forEach(k,function(I){_.isDate(I)?I=I.toISOString():_.isObject(I)&&(I=JSON.stringify(I)),S.push(f(y)+"="+f(I))}))}),m=S.join("&")}if(m){var R=p.indexOf("#");R!==-1&&(p=p.slice(0,R)),p+=(p.indexOf("?")===-1?"?":"&")+m}return p}},303:function(g){"use strict";g.exports=function(v,_){return _?v.replace(/\/+$/,"")+"/"+_.replace(/^\/+/,""):v}},372:function(g,C,v){"use strict";var _=v(867);g.exports=_.isStandardBrowserEnv()?function(){return{write:function(p,E,w,m,S,R){var A=[];A.push(p+"="+encodeURIComponent(E)),_.isNumber(w)&&A.push("expires="+new Date(w).toGMTString()),_.isString(m)&&A.push("path="+m),_.isString(S)&&A.push("domain="+S),R===!0&&A.push("secure"),document.cookie=A.join("; ")},read:function(p){var E=document.cookie.match(new RegExp("(^|;\\s*)("+p+")=([^;]*)"));return E?decodeURIComponent(E[3]):null},remove:function(p){this.write(p,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},793:function(g){"use strict";g.exports=function(v){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(v)}},268:function(g,C,v){"use strict";var _=v(867);g.exports=function(O){return _.isObject(O)&&O.isAxiosError===!0}},985:function(g,C,v){"use strict";var _=v(867);g.exports=_.isStandardBrowserEnv()?function(){var O=/(msie|trident)/i.test(navigator.userAgent),p=document.createElement("a"),E;function w(m){var S=m;return O&&(p.setAttribute("href",S),S=p.href),p.setAttribute("href",S),{href:p.href,protocol:p.protocol?p.protocol.replace(/:$/,""):"",host:p.host,search:p.search?p.search.replace(/^\?/,""):"",hash:p.hash?p.hash.replace(/^#/,""):"",hostname:p.hostname,port:p.port,pathname:p.pathname.charAt(0)==="/"?p.pathname:"/"+p.pathname}}return E=w(window.location.href),function(S){var R=_.isString(S)?w(S):S;return R.protocol===E.protocol&&R.host===E.host}}():function(){return function(){return!0}}()},16:function(g,C,v){"use strict";var _=v(867);g.exports=function(O,p){_.forEach(O,function(w,m){m!==p&&m.toUpperCase()===p.toUpperCase()&&(O[p]=w,delete O[m])})}},109:function(g,C,v){"use strict";var _=v(867),f=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];g.exports=function(p){var E={},w,m,S;return p&&_.forEach(p.split(`
`),function(A){if(S=A.indexOf(":"),w=_.trim(A.substr(0,S)).toLowerCase(),m=_.trim(A.substr(S+1)),w){if(E[w]&&f.indexOf(w)>=0)return;w==="set-cookie"?E[w]=(E[w]?E[w]:[]).concat([m]):E[w]=E[w]?E[w]+", "+m:m}}),E}},713:function(g){"use strict";g.exports=function(v){return function(f){return v.apply(null,f)}}},875:function(g,C,v){"use strict";var _=v(288).version,f={};["object","boolean","number","function","string","symbol"].forEach(function(E,w){f[E]=function(S){return typeof S===E||"a"+(w<1?"n ":" ")+E}});var O={};f.transitional=function(w,m,S){function R(A,k){return"[Axios v"+_+"] Transitional option '"+A+"'"+k+(S?". "+S:"")}return function(A,k,y){if(w===!1)throw new Error(R(k," has been removed"+(m?" in "+m:"")));return m&&!O[k]&&(O[k]=!0,console.warn(R(k," has been deprecated since v"+m+" and will be removed in the near future"))),w?w(A,k,y):!0}};function p(E,w,m){if(typeof E!="object")throw new TypeError("options must be an object");for(var S=Object.keys(E),R=S.length;R-- >0;){var A=S[R],k=w[A];if(k){var y=E[A],M=y===void 0||k(y,A,E);if(M!==!0)throw new TypeError("option "+A+" must be "+M);continue}if(m!==!0)throw Error("Unknown option "+A)}}g.exports={assertOptions:p,validators:f}},867:function(g,C,v){"use strict";var _=v(849),f=Object.prototype.toString;function O(x){return Array.isArray(x)}function p(x){return typeof x>"u"}function E(x){return x!==null&&!p(x)&&x.constructor!==null&&!p(x.constructor)&&typeof x.constructor.isBuffer=="function"&&x.constructor.isBuffer(x)}function w(x){return f.call(x)==="[object ArrayBuffer]"}function m(x){return f.call(x)==="[object FormData]"}function S(x){var oe;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?oe=ArrayBuffer.isView(x):oe=x&&x.buffer&&w(x.buffer),oe}function R(x){return typeof x=="string"}function A(x){return typeof x=="number"}function k(x){return x!==null&&typeof x=="object"}function y(x){if(f.call(x)!=="[object Object]")return!1;var oe=Object.getPrototypeOf(x);return oe===null||oe===Object.prototype}function M(x){return f.call(x)==="[object Date]"}function I(x){return f.call(x)==="[object File]"}function Y(x){return f.call(x)==="[object Blob]"}function K(x){return f.call(x)==="[object Function]"}function te(x){return k(x)&&K(x.pipe)}function pe(x){return f.call(x)==="[object URLSearchParams]"}function de(x){return x.trim?x.trim():x.replace(/^\s+|\s+$/g,"")}function ne(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function L(x,oe){if(!(x===null||typeof x>"u"))if(typeof x!="object"&&(x=[x]),O(x))for(var ae=0,Se=x.length;ae<Se;ae++)oe.call(null,x[ae],ae,x);else for(var re in x)Object.prototype.hasOwnProperty.call(x,re)&&oe.call(null,x[re],re,x)}function X(){var x={};function oe(re,me){y(x[me])&&y(re)?x[me]=X(x[me],re):y(re)?x[me]=X({},re):O(re)?x[me]=re.slice():x[me]=re}for(var ae=0,Se=arguments.length;ae<Se;ae++)L(arguments[ae],oe);return x}function Ee(x,oe,ae){return L(oe,function(re,me){ae&&typeof re=="function"?x[me]=_(re,ae):x[me]=re}),x}function Pe(x){return x.charCodeAt(0)===65279&&(x=x.slice(1)),x}g.exports={isArray:O,isArrayBuffer:w,isBuffer:E,isFormData:m,isArrayBufferView:S,isString:R,isNumber:A,isObject:k,isPlainObject:y,isUndefined:p,isDate:M,isFile:I,isBlob:Y,isFunction:K,isStream:te,isURLSearchParams:pe,isStandardBrowserEnv:ne,forEach:L,merge:X,extend:Ee,trim:de,stripBOM:Pe}},155:function(g){var C=g.exports={},v,_;function f(){throw new Error("setTimeout has not been defined")}function O(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?v=setTimeout:v=f}catch{v=f}try{typeof clearTimeout=="function"?_=clearTimeout:_=O}catch{_=O}})();function p(I){if(v===setTimeout)return setTimeout(I,0);if((v===f||!v)&&setTimeout)return v=setTimeout,setTimeout(I,0);try{return v(I,0)}catch{try{return v.call(null,I,0)}catch{return v.call(this,I,0)}}}function E(I){if(_===clearTimeout)return clearTimeout(I);if((_===O||!_)&&clearTimeout)return _=clearTimeout,clearTimeout(I);try{return _(I)}catch{try{return _.call(null,I)}catch{return _.call(this,I)}}}var w=[],m=!1,S,R=-1;function A(){!m||!S||(m=!1,S.length?w=S.concat(w):R=-1,w.length&&k())}function k(){if(!m){var I=p(A);m=!0;for(var Y=w.length;Y;){for(S=w,w=[];++R<Y;)S&&S[R].run();R=-1,Y=w.length}S=null,m=!1,E(I)}}C.nextTick=function(I){var Y=new Array(arguments.length-1);if(arguments.length>1)for(var K=1;K<arguments.length;K++)Y[K-1]=arguments[K];w.push(new y(I,Y)),w.length===1&&!m&&p(k)};function y(I,Y){this.fun=I,this.array=Y}y.prototype.run=function(){this.fun.apply(null,this.array)},C.title="browser",C.browser=!0,C.env={},C.argv=[],C.version="",C.versions={};function M(){}C.on=M,C.addListener=M,C.once=M,C.off=M,C.removeListener=M,C.removeAllListeners=M,C.emit=M,C.prependListener=M,C.prependOnceListener=M,C.listeners=function(I){return[]},C.binding=function(I){throw new Error("process.binding is not supported")},C.cwd=function(){return"/"},C.chdir=function(I){throw new Error("process.chdir is not supported")},C.umask=function(){return 0}}},fi={};function H(g){var C=fi[g];if(C!==void 0)return C.exports;var v=fi[g]={id:g,loaded:!1,exports:{}};return ci[g](v,v.exports,H),v.loaded=!0,v.exports}H.m=ci,function(){H.n=function(g){var C=g&&g.__esModule?function(){return g.default}:function(){return g};return H.d(C,{a:C}),C}}(),function(){H.d=function(g,C){for(var v in C)H.o(C,v)&&!H.o(g,v)&&Object.defineProperty(g,v,{enumerable:!0,get:C[v]})}}(),function(){H.f={},H.e=function(g){return Promise.all(Object.keys(H.f).reduce(function(C,v){return H.f[v](g,C),C},[]))}}(),function(){H.u=function(g){if(g===48)return"web.chunk.client.fb498cbf.js"}}(),function(){H.miniCssF=function(g){}}(),function(){H.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){H.hmd=function(g){return g=Object.create(g),g.children||(g.children=[]),Object.defineProperty(g,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+g.id)}}),g}}(),function(){H.o=function(g,C){return Object.prototype.hasOwnProperty.call(g,C)}}(),function(){var g={},C="client:";H.l=function(v,_,f,O){if(g[v]){g[v].push(_);return}var p,E;if(f!==void 0)for(var w=document.getElementsByTagName("script"),m=0;m<w.length;m++){var S=w[m];if(S.getAttribute("src")==v||S.getAttribute("data-webpack")==C+f){p=S;break}}p||(E=!0,p=document.createElement("script"),p.charset="utf-8",p.timeout=120,H.nc&&p.setAttribute("nonce",H.nc),p.setAttribute("data-webpack",C+f),p.src=v),g[v]=[_];var R=function(k,y){p.onerror=p.onload=null,clearTimeout(A);var M=g[v];if(delete g[v],p.parentNode&&p.parentNode.removeChild(p),M&&M.forEach(function(I){return I(y)}),k)return k(y)},A=setTimeout(R.bind(null,void 0,{type:"timeout",target:p}),12e4);p.onerror=R.bind(null,p.onerror),p.onload=R.bind(null,p.onload),E&&document.head.appendChild(p)}}(),function(){H.r=function(g){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})}}(),function(){H.p="/bundles/app/js/"}(),function(){if(typeof H<"u"){var g=H.u,C=H.e,v=new Map,_=new Map;H.u=function(f){var O=g(f);return O+(v.has(f)?"?"+v.get(f):"")},H.e=function(f){var O=C(f);return O.catch(function(p){var E=_.has(f)?_.get(f):2;if(E<1){var w=g(f);throw p.message="Loading chunk "+f+` failed after 2 retries.
(`+w+")",p.request=w,p}return new Promise(function(m){setTimeout(function(){var S=2-E+1,R="&retry-attempt="+S,A="cache-bust=true"+R;v.set(f,A),_.set(f,E-1),m(H.e(f))},0)})})}}}(),function(){var g={173:0};H.f.j=function(_,f){var O=H.o(g,_)?g[_]:void 0;if(O!==0)if(O)f.push(O[2]);else{var p=new Promise(function(S,R){O=g[_]=[S,R]});f.push(O[2]=p);var E=H.p+H.u(_),w=new Error,m=function(S){if(H.o(g,_)&&(O=g[_],O!==0&&(g[_]=void 0),O)){var R=S&&(S.type==="load"?"missing":S.type),A=S&&S.target&&S.target.src;w.message="Loading chunk "+_+` failed.
(`+R+": "+A+")",w.name="ChunkLoadError",w.type=R,w.request=A,O[1](w)}};H.l(E,m,"chunk-"+_,_)}};var C=function(_,f){var O=f[0],p=f[1],E=f[2],w,m,S=0;if(O.some(function(A){return g[A]!==0})){for(w in p)H.o(p,w)&&(H.m[w]=p[w]);if(E)var R=E(H)}for(_&&_(f);S<O.length;S++)m=O[S],H.o(g,m)&&g[m]&&g[m][0](),g[m]=0},v=(typeof self<"u"?self:this).wpChessCom_DvMz=(typeof self<"u"?self:this).wpChessCom_DvMz||[];v.forEach(C.bind(null,0)),v.push=C.bind(null,v.push.bind(v))}();var Ku={};(function(){"use strict";var g=H(155);function C(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function v(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _(e,n,t){return n&&v(e.prototype,n),t&&v(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var O="1.3.1";function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function E(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?p(Object(t),!0).forEach(function(i){f(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function w(e,n){switch(e){case m.TRANSPORT_NOT_SUPPORTED:return E({code:m.TRANSPORT_NOT_SUPPORTED,message:"transport not supported"},n);case m.MALFORMED_URL:return E({code:m.MALFORMED_URL,message:"malformed url"},n);case m.UNAUTHENTICATED:return E({code:m.UNAUTHENTICATED,message:"unauthenticated"},n)}}var m;(function(e){e[e.TRANSPORT_NOT_SUPPORTED=1]="TRANSPORT_NOT_SUPPORTED",e[e.MALFORMED_URL=2]="MALFORMED_URL",e[e.UNAUTHENTICATED=3]="UNAUTHENTICATED"})(m||(m={}));function S(e){if(Array.isArray(e))return e}function R(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i=[],r=!0,a=!1,s,o;try{for(t=t.call(e);!(r=(s=t.next()).done)&&(i.push(s.value),!(n&&i.length===n));r=!0);}catch(l){a=!0,o=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(a)throw o}}return i}}function A(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function k(e,n){if(!!e){if(typeof e=="string")return A(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return A(e,n)}}function y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M(e,n){return S(e)||R(e,n)||k(e,n)||y()}var I;(function(e){e.WEB_SOCKETS_NOT_SUPPORTED="web_socket_not_supported",e.WEB_SOCKET_ERROR="web_socket_error",e.CLIENT_OFFLINE="client_offline",e.WELCOME_TIMEOUT="welcome_timeout",e.WELCOME_EXPECTED="welcome_expected",e.WELCOME_INCONSISTENT="welcome_inconsitent",e.CORRUPTED_PACKET="corrupted_packet",e.CORRUPTED_OFFSET="corrupted_offset",e.CONNECTION_ERROR="connection_error",e.CONNECTION_CLOSED="connection_closed",e.KEEPALIVE_TIMEOUT="keepalive_timeout",e.CHANNEL_FAILURE="channel_failure",e.REGISTER_TIMEOUT="register_timeout",e.SUBSCRIBE_TIMEOUT="subscribe_timeout",e.UNSUBSCRIBE_TIMEOUT="unsubscribe_timeout"})(I||(I={}));function Y(e){return e===I.WELCOME_EXPECTED||e===I.WELCOME_INCONSISTENT||e===I.CORRUPTED_OFFSET||e===I.CORRUPTED_PACKET}var K;(function(e){e.SUBSCRIBE="1",e.UNSUBSCRIBE="2",e.ACK="3",e.SUBSCRIBED="5",e.UNSUBSCRIBED="6",e.MESSAGE="7",e.POSITION="8"})(K||(K={}));var te;(function(e){e.OPEN="0",e.CLOSE="1",e.PING="2",e.PONG="3",e.MESSAGE="4",e.PRESENCE="5"})(te||(te={}));var pe;(function(e){e.REGISTER="1",e.REGISTERED="2"})(pe||(pe={}));var de;(function(e){e[e.OFFLINE=0]="OFFLINE",e[e.POOR=1]="POOR",e[e.OK=2]="OK",e[e.GOOD=3]="GOOD",e[e.EXCELLENT=4]="EXCELLENT"})(de||(de={}));var ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof H.g<"u"?H.g:typeof self<"u"?self:{},L={exports:{}};(function(e,n){(function(t,i){e.exports=i(t)})(typeof self<"u"?self:typeof window<"u"?window:ne,function(t){t=t||{};var i=t.Base64,r="2.6.4",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(V){for(var N={},G=0,le=V.length;G<le;G++)N[V.charAt(G)]=G;return N}(a),o=String.fromCharCode,l=function(N){if(N.length<2){var G=N.charCodeAt(0);return G<128?N:G<2048?o(192|G>>>6)+o(128|G&63):o(224|G>>>12&15)+o(128|G>>>6&63)+o(128|G&63)}else{var G=65536+(N.charCodeAt(0)-55296)*1024+(N.charCodeAt(1)-56320);return o(240|G>>>18&7)+o(128|G>>>12&63)+o(128|G>>>6&63)+o(128|G&63)}},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(N){return N.replace(u,l)},h=function(N){var G=[0,2,1][N.length%3],le=N.charCodeAt(0)<<16|(N.length>1?N.charCodeAt(1):0)<<8|(N.length>2?N.charCodeAt(2):0),be=[a.charAt(le>>>18),a.charAt(le>>>12&63),G>=2?"=":a.charAt(le>>>6&63),G>=1?"=":a.charAt(le&63)];return be.join("")},d=t.btoa&&typeof t.btoa=="function"?function(V){return t.btoa(V)}:function(V){if(V.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return V.replace(/[\s\S]{1,3}/g,h)},b=function(N){return d(c(String(N)))},P=function(N){return N.replace(/[+\/]/g,function(G){return G=="+"?"-":"_"}).replace(/=/g,"")},T=function(N,G){return G?P(b(N)):b(N)},U=function(N){return T(N,!0)},D;t.Uint8Array&&(D=function(N,G){for(var le="",be=0,pn=N.length;be<pn;be+=3){var Wu=N[be],ga=N[be+1],ba=N[be+2],_n=Wu<<16|ga<<8|ba;le+=a.charAt(_n>>>18)+a.charAt(_n>>>12&63)+(typeof ga<"u"?a.charAt(_n>>>6&63):"=")+(typeof ba<"u"?a.charAt(_n&63):"=")}return G?P(le):le});var J=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,z=function(N){switch(N.length){case 4:var G=(7&N.charCodeAt(0))<<18|(63&N.charCodeAt(1))<<12|(63&N.charCodeAt(2))<<6|63&N.charCodeAt(3),le=G-65536;return o((le>>>10)+55296)+o((le&1023)+56320);case 3:return o((15&N.charCodeAt(0))<<12|(63&N.charCodeAt(1))<<6|63&N.charCodeAt(2));default:return o((31&N.charCodeAt(0))<<6|63&N.charCodeAt(1))}},Z=function(N){return N.replace(J,z)},j=function(N){var G=N.length,le=G%4,be=(G>0?s[N.charAt(0)]<<18:0)|(G>1?s[N.charAt(1)]<<12:0)|(G>2?s[N.charAt(2)]<<6:0)|(G>3?s[N.charAt(3)]:0),pn=[o(be>>>16),o(be>>>8&255),o(be&255)];return pn.length-=[0,0,2,1][le],pn.join("")},$=t.atob&&typeof t.atob=="function"?function(V){return t.atob(V)}:function(V){return V.replace(/\S{1,4}/g,j)},q=function(N){return $(String(N).replace(/[^A-Za-z0-9\+\/]/g,""))},F=function(N){return Z($(N))},W=function(N){return String(N).replace(/[-_]/g,function(G){return G=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")},ie=function(N){return F(W(N))},B;t.Uint8Array&&(B=function(N){return Uint8Array.from(q(W(N)),function(G){return G.charCodeAt(0)})});var ge=function(){var N=t.Base64;return t.Base64=i,N};if(t.Base64={VERSION:r,atob:q,btoa:d,fromBase64:ie,toBase64:T,utob:c,encode:T,encodeURI:U,btou:Z,decode:ie,noConflict:ge,fromUint8Array:D,toUint8Array:B},typeof Object.defineProperty=="function"){var Ye=function(N){return{value:N,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",Ye(function(){return ie(this)})),Object.defineProperty(String.prototype,"toBase64",Ye(function(V){return T(this,V)})),Object.defineProperty(String.prototype,"toBase64URI",Ye(function(){return T(this,!0)}))}}return t.Meteor&&(Base64=t.Base64),e.exports&&(e.exports.Base64=t.Base64),{Base64:t.Base64}})})(L);function X(e){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},X(e)}var Ee={};(function(e){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function t(a,s){return Object.prototype.hasOwnProperty.call(a,s)}e.assign=function(a){for(var s=Array.prototype.slice.call(arguments,1);s.length;){var o=s.shift();if(!!o){if(X(o)!=="object")throw new TypeError(o+"must be non-object");for(var l in o)t(o,l)&&(a[l]=o[l])}}return a},e.shrinkBuf=function(a,s){return a.length===s?a:a.subarray?a.subarray(0,s):(a.length=s,a)};var i={arraySet:function(s,o,l,u,c){if(o.subarray&&s.subarray){s.set(o.subarray(l,l+u),c);return}for(var h=0;h<u;h++)s[c+h]=o[l+h]},flattenChunks:function(s){var o,l,u,c,h,d;for(u=0,o=0,l=s.length;o<l;o++)u+=s[o].length;for(d=new Uint8Array(u),c=0,o=0,l=s.length;o<l;o++)h=s[o],d.set(h,c),c+=h.length;return d}},r={arraySet:function(s,o,l,u,c){for(var h=0;h<u;h++)s[c+h]=o[l+h]},flattenChunks:function(s){return[].concat.apply([],s)}};e.setTyped=function(a){a?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,r))},e.setTyped(n)})(Ee);var Pe={},x={},oe={},ae=Ee,Se=4,re=0,me=1,Et=2;function ht(e){for(var n=e.length;--n>=0;)e[n]=0}var ya=0,li=1,ma=2,wa=3,Ea=258,gn=29,St=256,kt=St+1+gn,dt=30,bn=19,hi=2*kt+1,et=15,yn=16,Sa=7,mn=256,di=16,vi=17,pi=18,wn=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$t=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ka=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],_i=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Oa=512,Me=new Array((kt+2)*2);ht(Me);var Ot=new Array(dt*2);ht(Ot);var xt=new Array(Oa);ht(xt);var Ct=new Array(Ea-wa+1);ht(Ct);var En=new Array(gn);ht(En);var Zt=new Array(dt);ht(Zt);function Sn(e,n,t,i,r){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}var gi,bi,yi;function kn(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function mi(e){return e<256?xt[e]:xt[256+(e>>>7)]}function At(e,n){e.pending_buf[e.pending++]=n&255,e.pending_buf[e.pending++]=n>>>8&255}function we(e,n,t){e.bi_valid>yn-t?(e.bi_buf|=n<<e.bi_valid&65535,At(e,e.bi_buf),e.bi_buf=n>>yn-e.bi_valid,e.bi_valid+=t-yn):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)}function De(e,n,t){we(e,t[n*2],t[n*2+1])}function wi(e,n){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--n>0);return t>>>1}function xa(e){e.bi_valid===16?(At(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function Ca(e,n){var t=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,a=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,o=n.stat_desc.extra_base,l=n.stat_desc.max_length,u,c,h,d,b,P,T=0;for(d=0;d<=et;d++)e.bl_count[d]=0;for(t[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<hi;u++)c=e.heap[u],d=t[t[c*2+1]*2+1]+1,d>l&&(d=l,T++),t[c*2+1]=d,!(c>i)&&(e.bl_count[d]++,b=0,c>=o&&(b=s[c-o]),P=t[c*2],e.opt_len+=P*(d+b),a&&(e.static_len+=P*(r[c*2+1]+b)));if(T!==0){do{for(d=l-1;e.bl_count[d]===0;)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,T-=2}while(T>0);for(d=l;d!==0;d--)for(c=e.bl_count[d];c!==0;)h=e.heap[--u],!(h>i)&&(t[h*2+1]!==d&&(e.opt_len+=(d-t[h*2+1])*t[h*2],t[h*2+1]=d),c--)}}function Ei(e,n,t){var i=new Array(et+1),r=0,a,s;for(a=1;a<=et;a++)i[a]=r=r+t[a-1]<<1;for(s=0;s<=n;s++){var o=e[s*2+1];o!==0&&(e[s*2]=wi(i[o]++,o))}}function Aa(){var e,n,t,i,r,a=new Array(et+1);for(t=0,i=0;i<gn-1;i++)for(En[i]=t,e=0;e<1<<wn[i];e++)Ct[t++]=i;for(Ct[t-1]=i,r=0,i=0;i<16;i++)for(Zt[i]=r,e=0;e<1<<$t[i];e++)xt[r++]=i;for(r>>=7;i<dt;i++)for(Zt[i]=r<<7,e=0;e<1<<$t[i]-7;e++)xt[256+r++]=i;for(n=0;n<=et;n++)a[n]=0;for(e=0;e<=143;)Me[e*2+1]=8,e++,a[8]++;for(;e<=255;)Me[e*2+1]=9,e++,a[9]++;for(;e<=279;)Me[e*2+1]=7,e++,a[7]++;for(;e<=287;)Me[e*2+1]=8,e++,a[8]++;for(Ei(Me,kt+1,a),e=0;e<dt;e++)Ot[e*2+1]=5,Ot[e*2]=wi(e,5);gi=new Sn(Me,wn,St+1,kt,et),bi=new Sn(Ot,$t,0,dt,et),yi=new Sn(new Array(0),ka,0,bn,Sa)}function Si(e){var n;for(n=0;n<kt;n++)e.dyn_ltree[n*2]=0;for(n=0;n<dt;n++)e.dyn_dtree[n*2]=0;for(n=0;n<bn;n++)e.bl_tree[n*2]=0;e.dyn_ltree[mn*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function ki(e){e.bi_valid>8?At(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Ra(e,n,t,i){ki(e),i&&(At(e,t),At(e,~t)),ae.arraySet(e.pending_buf,e.window,n,t,e.pending),e.pending+=t}function Oi(e,n,t,i){var r=n*2,a=t*2;return e[r]<e[a]||e[r]===e[a]&&i[n]<=i[t]}function On(e,n,t){for(var i=e.heap[t],r=t<<1;r<=e.heap_len&&(r<e.heap_len&&Oi(n,e.heap[r+1],e.heap[r],e.depth)&&r++,!Oi(n,i,e.heap[r],e.depth));)e.heap[t]=e.heap[r],t=r,r<<=1;e.heap[t]=i}function xi(e,n,t){var i,r,a=0,s,o;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],r=e.pending_buf[e.l_buf+a],a++,i===0?De(e,r,n):(s=Ct[r],De(e,s+St+1,n),o=wn[s],o!==0&&(r-=En[s],we(e,r,o)),i--,s=mi(i),De(e,s,t),o=$t[s],o!==0&&(i-=Zt[s],we(e,i,o)));while(a<e.last_lit);De(e,mn,n)}function xn(e,n){var t=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,a=n.stat_desc.elems,s,o,l=-1,u;for(e.heap_len=0,e.heap_max=hi,s=0;s<a;s++)t[s*2]!==0?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):t[s*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,t[u*2]=1,e.depth[u]=0,e.opt_len--,r&&(e.static_len-=i[u*2+1]);for(n.max_code=l,s=e.heap_len>>1;s>=1;s--)On(e,t,s);u=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],On(e,t,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,t[u*2]=t[s*2]+t[o*2],e.depth[u]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,t[s*2+1]=t[o*2+1]=u,e.heap[1]=u++,On(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Ca(e,n),Ei(t,l,e.bl_count)}function Ci(e,n,t){var i,r=-1,a,s=n[0*2+1],o=0,l=7,u=4;for(s===0&&(l=138,u=3),n[(t+1)*2+1]=65535,i=0;i<=t;i++)a=s,s=n[(i+1)*2+1],!(++o<l&&a===s)&&(o<u?e.bl_tree[a*2]+=o:a!==0?(a!==r&&e.bl_tree[a*2]++,e.bl_tree[di*2]++):o<=10?e.bl_tree[vi*2]++:e.bl_tree[pi*2]++,o=0,r=a,s===0?(l=138,u=3):a===s?(l=6,u=3):(l=7,u=4))}function Ai(e,n,t){var i,r=-1,a,s=n[0*2+1],o=0,l=7,u=4;for(s===0&&(l=138,u=3),i=0;i<=t;i++)if(a=s,s=n[(i+1)*2+1],!(++o<l&&a===s)){if(o<u)do De(e,a,e.bl_tree);while(--o!==0);else a!==0?(a!==r&&(De(e,a,e.bl_tree),o--),De(e,di,e.bl_tree),we(e,o-3,2)):o<=10?(De(e,vi,e.bl_tree),we(e,o-3,3)):(De(e,pi,e.bl_tree),we(e,o-11,7));o=0,r=a,s===0?(l=138,u=3):a===s?(l=6,u=3):(l=7,u=4)}}function Ta(e){var n;for(Ci(e,e.dyn_ltree,e.l_desc.max_code),Ci(e,e.dyn_dtree,e.d_desc.max_code),xn(e,e.bl_desc),n=bn-1;n>=3&&e.bl_tree[_i[n]*2+1]===0;n--);return e.opt_len+=3*(n+1)+5+5+4,n}function Pa(e,n,t,i){var r;for(we(e,n-257,5),we(e,t-1,5),we(e,i-4,4),r=0;r<i;r++)we(e,e.bl_tree[_i[r]*2+1],3);Ai(e,e.dyn_ltree,n-1),Ai(e,e.dyn_dtree,t-1)}function Da(e){var n=4093624447,t;for(t=0;t<=31;t++,n>>>=1)if(n&1&&e.dyn_ltree[t*2]!==0)return re;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return me;for(t=32;t<St;t++)if(e.dyn_ltree[t*2]!==0)return me;return re}var Ri=!1;function Na(e){Ri||(Aa(),Ri=!0),e.l_desc=new kn(e.dyn_ltree,gi),e.d_desc=new kn(e.dyn_dtree,bi),e.bl_desc=new kn(e.bl_tree,yi),e.bi_buf=0,e.bi_valid=0,Si(e)}function Ti(e,n,t,i){we(e,(ya<<1)+(i?1:0),3),Ra(e,n,t,!0)}function Ia(e){we(e,li<<1,3),De(e,mn,Me),xa(e)}function ja(e,n,t,i){var r,a,s=0;e.level>0?(e.strm.data_type===Et&&(e.strm.data_type=Da(e)),xn(e,e.l_desc),xn(e,e.d_desc),s=Ta(e),r=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=r&&(r=a)):r=a=t+5,t+4<=r&&n!==-1?Ti(e,n,t,i):e.strategy===Se||a===r?(we(e,(li<<1)+(i?1:0),3),xi(e,Me,Ot)):(we(e,(ma<<1)+(i?1:0),3),Pa(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),xi(e,e.dyn_ltree,e.dyn_dtree)),Si(e),i&&ki(e)}function Ua(e,n,t){return e.pending_buf[e.d_buf+e.last_lit*2]=n>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=n&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,n===0?e.dyn_ltree[t*2]++:(e.matches++,n--,e.dyn_ltree[(Ct[t]+St+1)*2]++,e.dyn_dtree[mi(n)*2]++),e.last_lit===e.lit_bufsize-1}oe._tr_init=Na,oe._tr_stored_block=Ti,oe._tr_flush_block=ja,oe._tr_tally=Ua,oe._tr_align=Ia;function Ma(e,n,t,i){for(var r=e&65535|0,a=e>>>16&65535|0,s=0;t!==0;){s=t>2e3?2e3:t,t-=s;do r=r+n[i++]|0,a=a+r|0;while(--s);r%=65521,a%=65521}return r|a<<16|0}var Pi=Ma;function La(){for(var e,n=[],t=0;t<256;t++){e=t;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;n[t]=e}return n}var Ba=La();function Fa(e,n,t,i){var r=Ba,a=i+t;e^=-1;for(var s=i;s<a;s++)e=e>>>8^r[(e^n[s])&255];return e^-1}var Di=Fa,Cn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ye=Ee,Oe=oe,Ni=Pi,Ge=Di,za=Cn,tt=0,Ha=1,$a=3,We=4,Ii=5,Ne=0,ji=1,xe=-2,Za=-3,An=-5,qa=-1,Ga=1,qt=2,Wa=3,Ka=4,Va=0,Qa=2,Gt=8,Xa=9,Ja=15,Ya=8,es=29,ts=256,Rn=ts+1+es,ns=30,is=19,rs=2*Rn+1,as=15,Q=3,Ke=258,Re=Ke+Q+1,ss=32,Wt=42,Tn=69,Kt=73,Vt=91,Qt=103,nt=113,Rt=666,he=1,Tt=2,it=3,vt=4,os=3;function Ve(e,n){return e.msg=za[n],n}function Ui(e){return(e<<1)-(e>4?9:0)}function Qe(e){for(var n=e.length;--n>=0;)e[n]=0}function Xe(e){var n=e.state,t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(ye.arraySet(e.output,n.pending_buf,n.pending_out,t,e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))}function ve(e,n){Oe._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,Xe(e.strm)}function ee(e,n){e.pending_buf[e.pending++]=n}function Pt(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=n&255}function us(e,n,t,i){var r=e.avail_in;return r>i&&(r=i),r===0?0:(e.avail_in-=r,ye.arraySet(n,e.input,e.next_in,r,t),e.state.wrap===1?e.adler=Ni(e.adler,n,r,t):e.state.wrap===2&&(e.adler=Ge(e.adler,n,r,t)),e.next_in+=r,e.total_in+=r,r)}function Mi(e,n){var t=e.max_chain_length,i=e.strstart,r,a,s=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-Re?e.strstart-(e.w_size-Re):0,u=e.window,c=e.w_mask,h=e.prev,d=e.strstart+Ke,b=u[i+s-1],P=u[i+s];e.prev_length>=e.good_match&&(t>>=2),o>e.lookahead&&(o=e.lookahead);do if(r=n,!(u[r+s]!==P||u[r+s-1]!==b||u[r]!==u[i]||u[++r]!==u[i+1])){i+=2,r++;do;while(u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&i<d);if(a=Ke-(d-i),i=d-Ke,a>s){if(e.match_start=n,s=a,a>=o)break;b=u[i+s-1],P=u[i+s]}}while((n=h[n&c])>l&&--t!==0);return s<=e.lookahead?s:e.lookahead}function rt(e){var n=e.w_size,t,i,r,a,s;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-Re)){ye.arraySet(e.window,e.window,n,n,0),e.match_start-=n,e.strstart-=n,e.block_start-=n,i=e.hash_size,t=i;do r=e.head[--t],e.head[t]=r>=n?r-n:0;while(--i);i=n,t=i;do r=e.prev[--t],e.prev[t]=r>=n?r-n:0;while(--i);a+=n}if(e.strm.avail_in===0)break;if(i=us(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=i,e.lookahead+e.insert>=Q)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+Q-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<Q)););}while(e.lookahead<Re&&e.strm.avail_in!==0)}function cs(e,n){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(rt(e),e.lookahead===0&&n===tt)return he;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+t;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,ve(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Re&&(ve(e,!1),e.strm.avail_out===0))return he}return e.insert=0,n===We?(ve(e,!0),e.strm.avail_out===0?it:vt):(e.strstart>e.block_start&&(ve(e,!1),e.strm.avail_out===0),he)}function Pn(e,n){for(var t,i;;){if(e.lookahead<Re){if(rt(e),e.lookahead<Re&&n===tt)return he;if(e.lookahead===0)break}if(t=0,e.lookahead>=Q&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Q-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-Re&&(e.match_length=Mi(e,t)),e.match_length>=Q)if(i=Oe._tr_tally(e,e.strstart-e.match_start,e.match_length-Q),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Q){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Q-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=Oe._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ve(e,!1),e.strm.avail_out===0))return he}return e.insert=e.strstart<Q-1?e.strstart:Q-1,n===We?(ve(e,!0),e.strm.avail_out===0?it:vt):e.last_lit&&(ve(e,!1),e.strm.avail_out===0)?he:Tt}function pt(e,n){for(var t,i,r;;){if(e.lookahead<Re){if(rt(e),e.lookahead<Re&&n===tt)return he;if(e.lookahead===0)break}if(t=0,e.lookahead>=Q&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Q-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Q-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-Re&&(e.match_length=Mi(e,t),e.match_length<=5&&(e.strategy===Ga||e.match_length===Q&&e.strstart-e.match_start>4096)&&(e.match_length=Q-1)),e.prev_length>=Q&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-Q,i=Oe._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-Q),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Q-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Q-1,e.strstart++,i&&(ve(e,!1),e.strm.avail_out===0))return he}else if(e.match_available){if(i=Oe._tr_tally(e,0,e.window[e.strstart-1]),i&&ve(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return he}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Oe._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Q-1?e.strstart:Q-1,n===We?(ve(e,!0),e.strm.avail_out===0?it:vt):e.last_lit&&(ve(e,!1),e.strm.avail_out===0)?he:Tt}function fs(e,n){for(var t,i,r,a,s=e.window;;){if(e.lookahead<=Ke){if(rt(e),e.lookahead<=Ke&&n===tt)return he;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Q&&e.strstart>0&&(r=e.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){a=e.strstart+Ke;do;while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a);e.match_length=Ke-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Q?(t=Oe._tr_tally(e,1,e.match_length-Q),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=Oe._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(ve(e,!1),e.strm.avail_out===0))return he}return e.insert=0,n===We?(ve(e,!0),e.strm.avail_out===0?it:vt):e.last_lit&&(ve(e,!1),e.strm.avail_out===0)?he:Tt}function ls(e,n){for(var t;;){if(e.lookahead===0&&(rt(e),e.lookahead===0)){if(n===tt)return he;break}if(e.match_length=0,t=Oe._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(ve(e,!1),e.strm.avail_out===0))return he}return e.insert=0,n===We?(ve(e,!0),e.strm.avail_out===0?it:vt):e.last_lit&&(ve(e,!1),e.strm.avail_out===0)?he:Tt}function Ie(e,n,t,i,r){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=i,this.func=r}var _t;_t=[new Ie(0,0,0,0,cs),new Ie(4,4,8,4,Pn),new Ie(4,5,16,8,Pn),new Ie(4,6,32,32,Pn),new Ie(4,4,16,16,pt),new Ie(8,16,32,32,pt),new Ie(8,16,128,128,pt),new Ie(8,32,128,256,pt),new Ie(32,128,258,1024,pt),new Ie(32,258,258,4096,pt)];function hs(e){e.window_size=2*e.w_size,Qe(e.head),e.max_lazy_match=_t[e.level].max_lazy,e.good_match=_t[e.level].good_length,e.nice_match=_t[e.level].nice_length,e.max_chain_length=_t[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Q-1,e.match_available=0,e.ins_h=0}function ds(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Gt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ye.Buf16(rs*2),this.dyn_dtree=new ye.Buf16((2*ns+1)*2),this.bl_tree=new ye.Buf16((2*is+1)*2),Qe(this.dyn_ltree),Qe(this.dyn_dtree),Qe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ye.Buf16(as+1),this.heap=new ye.Buf16(2*Rn+1),Qe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ye.Buf16(2*Rn+1),Qe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Li(e){var n;return!e||!e.state?Ve(e,xe):(e.total_in=e.total_out=0,e.data_type=Qa,n=e.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?Wt:nt,e.adler=n.wrap===2?0:1,n.last_flush=tt,Oe._tr_init(n),Ne)}function Bi(e){var n=Li(e);return n===Ne&&hs(e.state),n}function vs(e,n){return!e||!e.state||e.state.wrap!==2?xe:(e.state.gzhead=n,Ne)}function Fi(e,n,t,i,r,a){if(!e)return xe;var s=1;if(n===qa&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>Xa||t!==Gt||i<8||i>15||n<0||n>9||a<0||a>Ka)return Ve(e,xe);i===8&&(i=9);var o=new ds;return e.state=o,o.strm=e,o.wrap=s,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Q-1)/Q),o.window=new ye.Buf8(o.w_size*2),o.head=new ye.Buf16(o.hash_size),o.prev=new ye.Buf16(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new ye.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=n,o.strategy=a,o.method=t,Bi(e)}function ps(e,n){return Fi(e,n,Gt,Ja,Ya,Va)}function _s(e,n){var t,i,r,a;if(!e||!e.state||n>Ii||n<0)return e?Ve(e,xe):xe;if(i=e.state,!e.output||!e.input&&e.avail_in!==0||i.status===Rt&&n!==We)return Ve(e,e.avail_out===0?An:xe);if(i.strm=e,t=i.last_flush,i.last_flush=n,i.status===Wt)if(i.wrap===2)e.adler=0,ee(i,31),ee(i,139),ee(i,8),i.gzhead?(ee(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ee(i,i.gzhead.time&255),ee(i,i.gzhead.time>>8&255),ee(i,i.gzhead.time>>16&255),ee(i,i.gzhead.time>>24&255),ee(i,i.level===9?2:i.strategy>=qt||i.level<2?4:0),ee(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(ee(i,i.gzhead.extra.length&255),ee(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Ge(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Tn):(ee(i,0),ee(i,0),ee(i,0),ee(i,0),ee(i,0),ee(i,i.level===9?2:i.strategy>=qt||i.level<2?4:0),ee(i,os),i.status=nt);else{var s=Gt+(i.w_bits-8<<4)<<8,o=-1;i.strategy>=qt||i.level<2?o=0:i.level<6?o=1:i.level===6?o=2:o=3,s|=o<<6,i.strstart!==0&&(s|=ss),s+=31-s%31,i.status=nt,Pt(i,s),i.strstart!==0&&(Pt(i,e.adler>>>16),Pt(i,e.adler&65535)),e.adler=1}if(i.status===Tn)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Ge(e.adler,i.pending_buf,i.pending-r,r)),Xe(e),r=i.pending,i.pending===i.pending_buf_size));)ee(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(e.adler=Ge(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Kt)}else i.status=Kt;if(i.status===Kt)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Ge(e.adler,i.pending_buf,i.pending-r,r)),Xe(e),r=i.pending,i.pending===i.pending_buf_size)){a=1;break}i.gzindex<i.gzhead.name.length?a=i.gzhead.name.charCodeAt(i.gzindex++)&255:a=0,ee(i,a)}while(a!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=Ge(e.adler,i.pending_buf,i.pending-r,r)),a===0&&(i.gzindex=0,i.status=Vt)}else i.status=Vt;if(i.status===Vt)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=Ge(e.adler,i.pending_buf,i.pending-r,r)),Xe(e),r=i.pending,i.pending===i.pending_buf_size)){a=1;break}i.gzindex<i.gzhead.comment.length?a=i.gzhead.comment.charCodeAt(i.gzindex++)&255:a=0,ee(i,a)}while(a!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=Ge(e.adler,i.pending_buf,i.pending-r,r)),a===0&&(i.status=Qt)}else i.status=Qt;if(i.status===Qt&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Xe(e),i.pending+2<=i.pending_buf_size&&(ee(i,e.adler&255),ee(i,e.adler>>8&255),e.adler=0,i.status=nt)):i.status=nt),i.pending!==0){if(Xe(e),e.avail_out===0)return i.last_flush=-1,Ne}else if(e.avail_in===0&&Ui(n)<=Ui(t)&&n!==We)return Ve(e,An);if(i.status===Rt&&e.avail_in!==0)return Ve(e,An);if(e.avail_in!==0||i.lookahead!==0||n!==tt&&i.status!==Rt){var l=i.strategy===qt?ls(i,n):i.strategy===Wa?fs(i,n):_t[i.level].func(i,n);if((l===it||l===vt)&&(i.status=Rt),l===he||l===it)return e.avail_out===0&&(i.last_flush=-1),Ne;if(l===Tt&&(n===Ha?Oe._tr_align(i):n!==Ii&&(Oe._tr_stored_block(i,0,0,!1),n===$a&&(Qe(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Xe(e),e.avail_out===0))return i.last_flush=-1,Ne}return n!==We?Ne:i.wrap<=0?ji:(i.wrap===2?(ee(i,e.adler&255),ee(i,e.adler>>8&255),ee(i,e.adler>>16&255),ee(i,e.adler>>24&255),ee(i,e.total_in&255),ee(i,e.total_in>>8&255),ee(i,e.total_in>>16&255),ee(i,e.total_in>>24&255)):(Pt(i,e.adler>>>16),Pt(i,e.adler&65535)),Xe(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ne:ji)}function gs(e){var n;return!e||!e.state?xe:(n=e.state.status,n!==Wt&&n!==Tn&&n!==Kt&&n!==Vt&&n!==Qt&&n!==nt&&n!==Rt?Ve(e,xe):(e.state=null,n===nt?Ve(e,Za):Ne))}function bs(e,n){var t=n.length,i,r,a,s,o,l,u,c;if(!e||!e.state||(i=e.state,s=i.wrap,s===2||s===1&&i.status!==Wt||i.lookahead))return xe;for(s===1&&(e.adler=Ni(e.adler,n,t,0)),i.wrap=0,t>=i.w_size&&(s===0&&(Qe(i.head),i.strstart=0,i.block_start=0,i.insert=0),c=new ye.Buf8(i.w_size),ye.arraySet(c,n,t-i.w_size,i.w_size,0),n=c,t=i.w_size),o=e.avail_in,l=e.next_in,u=e.input,e.avail_in=t,e.next_in=0,e.input=n,rt(i);i.lookahead>=Q;){r=i.strstart,a=i.lookahead-(Q-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+Q-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++;while(--a);i.strstart=r,i.lookahead=Q-1,rt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Q-1,i.match_available=0,e.next_in=l,e.input=u,e.avail_in=o,i.wrap=s,Ne}x.deflateInit=ps,x.deflateInit2=Fi,x.deflateReset=Bi,x.deflateResetKeep=Li,x.deflateSetHeader=vs,x.deflate=_s,x.deflateEnd=gs,x.deflateSetDictionary=bs,x.deflateInfo="pako deflate (from Nodeca project)";var at={},Xt=Ee,zi=!0,Hi=!0;try{String.fromCharCode.apply(null,[0])}catch{zi=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Hi=!1}for(var Dt=new Xt.Buf8(256),Je=0;Je<256;Je++)Dt[Je]=Je>=252?6:Je>=248?5:Je>=240?4:Je>=224?3:Je>=192?2:1;Dt[254]=Dt[254]=1,at.string2buf=function(e){var n,t,i,r,a,s=e.length,o=0;for(r=0;r<s;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<s&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(n=new Xt.Buf8(o),a=0,r=0;a<o;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<s&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),t<128?n[a++]=t:t<2048?(n[a++]=192|t>>>6,n[a++]=128|t&63):t<65536?(n[a++]=224|t>>>12,n[a++]=128|t>>>6&63,n[a++]=128|t&63):(n[a++]=240|t>>>18,n[a++]=128|t>>>12&63,n[a++]=128|t>>>6&63,n[a++]=128|t&63);return n};function $i(e,n){if(n<65534&&(e.subarray&&Hi||!e.subarray&&zi))return String.fromCharCode.apply(null,Xt.shrinkBuf(e,n));for(var t="",i=0;i<n;i++)t+=String.fromCharCode(e[i]);return t}at.buf2binstring=function(e){return $i(e,e.length)},at.binstring2buf=function(e){for(var n=new Xt.Buf8(e.length),t=0,i=n.length;t<i;t++)n[t]=e.charCodeAt(t);return n},at.buf2string=function(e,n){var t,i,r,a,s=n||e.length,o=new Array(s*2);for(i=0,t=0;t<s;){if(r=e[t++],r<128){o[i++]=r;continue}if(a=Dt[r],a>4){o[i++]=65533,t+=a-1;continue}for(r&=a===2?31:a===3?15:7;a>1&&t<s;)r=r<<6|e[t++]&63,a--;if(a>1){o[i++]=65533;continue}r<65536?o[i++]=r:(r-=65536,o[i++]=55296|r>>10&1023,o[i++]=56320|r&1023)}return $i(o,i)},at.utf8border=function(e,n){var t;for(n=n||e.length,n>e.length&&(n=e.length),t=n-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?n:t+Dt[e[t]]>n?t:n};function ys(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zi=ys,Nt=x,It=Ee,Dn=at,Nn=Cn,ms=Zi,qi=Object.prototype.toString,ws=0,In=4,gt=0,Gi=1,Wi=2,Es=-1,Ss=0,ks=8;function st(e){if(!(this instanceof st))return new st(e);this.options=It.assign({level:Es,method:ks,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ss,to:""},e||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ms,this.strm.avail_out=0;var t=Nt.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==gt)throw new Error(Nn[t]);if(n.header&&Nt.deflateSetHeader(this.strm,n.header),n.dictionary){var i;if(typeof n.dictionary=="string"?i=Dn.string2buf(n.dictionary):qi.call(n.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(n.dictionary):i=n.dictionary,t=Nt.deflateSetDictionary(this.strm,i),t!==gt)throw new Error(Nn[t]);this._dict_set=!0}}st.prototype.push=function(e,n){var t=this.strm,i=this.options.chunkSize,r,a;if(this.ended)return!1;a=n===~~n?n:n===!0?In:ws,typeof e=="string"?t.input=Dn.string2buf(e):qi.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new It.Buf8(i),t.next_out=0,t.avail_out=i),r=Nt.deflate(t,a),r!==Gi&&r!==gt)return this.onEnd(r),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(a===In||a===Wi))&&(this.options.to==="string"?this.onData(Dn.buf2binstring(It.shrinkBuf(t.output,t.next_out))):this.onData(It.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&r!==Gi);return a===In?(r=Nt.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===gt):(a===Wi&&(this.onEnd(gt),t.avail_out=0),!0)},st.prototype.onData=function(e){this.chunks.push(e)},st.prototype.onEnd=function(e){e===gt&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=It.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function jn(e,n){var t=new st(n);if(t.push(e,!0),t.err)throw t.msg||Nn[t.err];return t.result}function Os(e,n){return n=n||{},n.raw=!0,jn(e,n)}function xs(e,n){return n=n||{},n.gzip=!0,jn(e,n)}Pe.Deflate=st,Pe.deflate=jn,Pe.deflateRaw=Os,Pe.gzip=xs;var jt={},Te={},Jt=30,Cs=12,As=function(n,t){var i,r,a,s,o,l,u,c,h,d,b,P,T,U,D,J,z,Z,j,$,q,F,W,ie,B;i=n.state,r=n.next_in,ie=n.input,a=r+(n.avail_in-5),s=n.next_out,B=n.output,o=s-(t-n.avail_out),l=s+(n.avail_out-257),u=i.dmax,c=i.wsize,h=i.whave,d=i.wnext,b=i.window,P=i.hold,T=i.bits,U=i.lencode,D=i.distcode,J=(1<<i.lenbits)-1,z=(1<<i.distbits)-1;e:do{T<15&&(P+=ie[r++]<<T,T+=8,P+=ie[r++]<<T,T+=8),Z=U[P&J];t:for(;;){if(j=Z>>>24,P>>>=j,T-=j,j=Z>>>16&255,j===0)B[s++]=Z&65535;else if(j&16){$=Z&65535,j&=15,j&&(T<j&&(P+=ie[r++]<<T,T+=8),$+=P&(1<<j)-1,P>>>=j,T-=j),T<15&&(P+=ie[r++]<<T,T+=8,P+=ie[r++]<<T,T+=8),Z=D[P&z];n:for(;;){if(j=Z>>>24,P>>>=j,T-=j,j=Z>>>16&255,j&16){if(q=Z&65535,j&=15,T<j&&(P+=ie[r++]<<T,T+=8,T<j&&(P+=ie[r++]<<T,T+=8)),q+=P&(1<<j)-1,q>u){n.msg="invalid distance too far back",i.mode=Jt;break e}if(P>>>=j,T-=j,j=s-o,q>j){if(j=q-j,j>h&&i.sane){n.msg="invalid distance too far back",i.mode=Jt;break e}if(F=0,W=b,d===0){if(F+=c-j,j<$){$-=j;do B[s++]=b[F++];while(--j);F=s-q,W=B}}else if(d<j){if(F+=c+d-j,j-=d,j<$){$-=j;do B[s++]=b[F++];while(--j);if(F=0,d<$){j=d,$-=j;do B[s++]=b[F++];while(--j);F=s-q,W=B}}}else if(F+=d-j,j<$){$-=j;do B[s++]=b[F++];while(--j);F=s-q,W=B}for(;$>2;)B[s++]=W[F++],B[s++]=W[F++],B[s++]=W[F++],$-=3;$&&(B[s++]=W[F++],$>1&&(B[s++]=W[F++]))}else{F=s-q;do B[s++]=B[F++],B[s++]=B[F++],B[s++]=B[F++],$-=3;while($>2);$&&(B[s++]=B[F++],$>1&&(B[s++]=B[F++]))}}else if((j&64)===0){Z=D[(Z&65535)+(P&(1<<j)-1)];continue n}else{n.msg="invalid distance code",i.mode=Jt;break e}break}}else if((j&64)===0){Z=U[(Z&65535)+(P&(1<<j)-1)];continue t}else if(j&32){i.mode=Cs;break e}else{n.msg="invalid literal/length code",i.mode=Jt;break e}break}}while(r<a&&s<l);$=T>>3,r-=$,T-=$<<3,P&=(1<<T)-1,n.next_in=r,n.next_out=s,n.avail_in=r<a?5+(a-r):5-(r-a),n.avail_out=s<l?257+(l-s):257-(s-l),i.hold=P,i.bits=T},Ki=Ee,bt=15,Vi=852,Qi=592,Xi=0,Un=1,Ji=2,Rs=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ts=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ps=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Ds=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Ns=function(n,t,i,r,a,s,o,l){var u=l.bits,c=0,h=0,d=0,b=0,P=0,T=0,U=0,D=0,J=0,z=0,Z,j,$,q,F,W=null,ie=0,B,ge=new Ki.Buf16(bt+1),Ye=new Ki.Buf16(bt+1),V=null,N=0,G,le,be;for(c=0;c<=bt;c++)ge[c]=0;for(h=0;h<r;h++)ge[t[i+h]]++;for(P=u,b=bt;b>=1&&ge[b]===0;b--);if(P>b&&(P=b),b===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<b&&ge[d]===0;d++);for(P<d&&(P=d),D=1,c=1;c<=bt;c++)if(D<<=1,D-=ge[c],D<0)return-1;if(D>0&&(n===Xi||b!==1))return-1;for(Ye[1]=0,c=1;c<bt;c++)Ye[c+1]=Ye[c]+ge[c];for(h=0;h<r;h++)t[i+h]!==0&&(o[Ye[t[i+h]]++]=h);if(n===Xi?(W=V=o,B=19):n===Un?(W=Rs,ie-=257,V=Ts,N-=257,B=256):(W=Ps,V=Ds,B=-1),z=0,h=0,c=d,F=s,T=P,U=0,$=-1,J=1<<P,q=J-1,n===Un&&J>Vi||n===Ji&&J>Qi)return 1;for(;;){G=c-U,o[h]<B?(le=0,be=o[h]):o[h]>B?(le=V[N+o[h]],be=W[ie+o[h]]):(le=32+64,be=0),Z=1<<c-U,j=1<<T,d=j;do j-=Z,a[F+(z>>U)+j]=G<<24|le<<16|be|0;while(j!==0);for(Z=1<<c-1;z&Z;)Z>>=1;if(Z!==0?(z&=Z-1,z+=Z):z=0,h++,--ge[c]===0){if(c===b)break;c=t[i+o[h]]}if(c>P&&(z&q)!==$){for(U===0&&(U=P),F+=d,T=c-U,D=1<<T;T+U<b&&(D-=ge[T+U],!(D<=0));)T++,D<<=1;if(J+=1<<T,n===Un&&J>Vi||n===Ji&&J>Qi)return 1;$=z&q,a[$]=P<<24|T<<16|F-s|0}}return z!==0&&(a[F+z]=c-U<<24|64<<16|0),l.bits=P,0},ke=Ee,Mn=Pi,je=Di,Is=As,Ut=Ns,js=0,Yi=1,er=2,tr=4,Us=5,Yt=6,ot=0,Ms=1,Ls=2,Ce=-2,nr=-3,ir=-4,Bs=-5,rr=8,ar=1,sr=2,or=3,ur=4,cr=5,fr=6,lr=7,hr=8,dr=9,vr=10,en=11,Le=12,Ln=13,pr=14,Bn=15,_r=16,gr=17,br=18,yr=19,tn=20,nn=21,mr=22,wr=23,Er=24,Sr=25,kr=26,Fn=27,Or=28,xr=29,se=30,Cr=31,Fs=32,zs=852,Hs=592,$s=15,Zs=$s;function Ar(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function qs(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ke.Buf16(320),this.work=new ke.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Rr(e){var n;return!e||!e.state?Ce:(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=n.wrap&1),n.mode=ar,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new ke.Buf32(zs),n.distcode=n.distdyn=new ke.Buf32(Hs),n.sane=1,n.back=-1,ot)}function Tr(e){var n;return!e||!e.state?Ce:(n=e.state,n.wsize=0,n.whave=0,n.wnext=0,Rr(e))}function Pr(e,n){var t,i;return!e||!e.state||(i=e.state,n<0?(t=0,n=-n):(t=(n>>4)+1,n<48&&(n&=15)),n&&(n<8||n>15))?Ce:(i.window!==null&&i.wbits!==n&&(i.window=null),i.wrap=t,i.wbits=n,Tr(e))}function Dr(e,n){var t,i;return e?(i=new qs,e.state=i,i.window=null,t=Pr(e,n),t!==ot&&(e.state=null),t):Ce}function Gs(e){return Dr(e,Zs)}var Nr=!0,zn,Hn;function Ws(e){if(Nr){var n;for(zn=new ke.Buf32(512),Hn=new ke.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(Ut(Yi,e.lens,0,288,zn,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;Ut(er,e.lens,0,32,Hn,0,e.work,{bits:5}),Nr=!1}e.lencode=zn,e.lenbits=9,e.distcode=Hn,e.distbits=5}function Ir(e,n,t,i){var r,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new ke.Buf8(a.wsize)),i>=a.wsize?(ke.arraySet(a.window,n,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>i&&(r=i),ke.arraySet(a.window,n,t-i,r,a.wnext),i-=r,i?(ke.arraySet(a.window,n,t-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}function Ks(e,n){var t,i,r,a,s,o,l,u,c,h,d,b,P,T,U=0,D,J,z,Z,j,$,q,F,W=new ke.Buf8(4),ie,B,ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Ce;t=e.state,t.mode===Le&&(t.mode=Ln),s=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,i=e.input,o=e.avail_in,u=t.hold,c=t.bits,h=o,d=l,F=ot;e:for(;;)switch(t.mode){case ar:if(t.wrap===0){t.mode=Ln;break}for(;c<16;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(t.wrap&2&&u===35615){t.check=0,W[0]=u&255,W[1]=u>>>8&255,t.check=je(t.check,W,2,0),u=0,c=0,t.mode=sr;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",t.mode=se;break}if((u&15)!==rr){e.msg="unknown compression method",t.mode=se;break}if(u>>>=4,c-=4,q=(u&15)+8,t.wbits===0)t.wbits=q;else if(q>t.wbits){e.msg="invalid window size",t.mode=se;break}t.dmax=1<<q,e.adler=t.check=1,t.mode=u&512?vr:Le,u=0,c=0;break;case sr:for(;c<16;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(t.flags=u,(t.flags&255)!==rr){e.msg="unknown compression method",t.mode=se;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=se;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&(W[0]=u&255,W[1]=u>>>8&255,t.check=je(t.check,W,2,0)),u=0,c=0,t.mode=or;case or:for(;c<32;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}t.head&&(t.head.time=u),t.flags&512&&(W[0]=u&255,W[1]=u>>>8&255,W[2]=u>>>16&255,W[3]=u>>>24&255,t.check=je(t.check,W,4,0)),u=0,c=0,t.mode=ur;case ur:for(;c<16;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&(W[0]=u&255,W[1]=u>>>8&255,t.check=je(t.check,W,2,0)),u=0,c=0,t.mode=cr;case cr:if(t.flags&1024){for(;c<16;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&(W[0]=u&255,W[1]=u>>>8&255,t.check=je(t.check,W,2,0)),u=0,c=0}else t.head&&(t.head.extra=null);t.mode=fr;case fr:if(t.flags&1024&&(b=t.length,b>o&&(b=o),b&&(t.head&&(q=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),ke.arraySet(t.head.extra,i,a,b,q)),t.flags&512&&(t.check=je(t.check,i,b,a)),o-=b,a+=b,t.length-=b),t.length))break e;t.length=0,t.mode=lr;case lr:if(t.flags&2048){if(o===0)break e;b=0;do q=i[a+b++],t.head&&q&&t.length<65536&&(t.head.name+=String.fromCharCode(q));while(q&&b<o);if(t.flags&512&&(t.check=je(t.check,i,b,a)),o-=b,a+=b,q)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=hr;case hr:if(t.flags&4096){if(o===0)break e;b=0;do q=i[a+b++],t.head&&q&&t.length<65536&&(t.head.comment+=String.fromCharCode(q));while(q&&b<o);if(t.flags&512&&(t.check=je(t.check,i,b,a)),o-=b,a+=b,q)break e}else t.head&&(t.head.comment=null);t.mode=dr;case dr:if(t.flags&512){for(;c<16;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(u!==(t.check&65535)){e.msg="header crc mismatch",t.mode=se;break}u=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=Le;break;case vr:for(;c<32;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}e.adler=t.check=Ar(u),u=0,c=0,t.mode=en;case en:if(t.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,t.hold=u,t.bits=c,Ls;e.adler=t.check=1,t.mode=Le;case Le:if(n===Us||n===Yt)break e;case Ln:if(t.last){u>>>=c&7,c-=c&7,t.mode=Fn;break}for(;c<3;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}switch(t.last=u&1,u>>>=1,c-=1,u&3){case 0:t.mode=pr;break;case 1:if(Ws(t),t.mode=tn,n===Yt){u>>>=2,c-=2;break e}break;case 2:t.mode=gr;break;case 3:e.msg="invalid block type",t.mode=se}u>>>=2,c-=2;break;case pr:for(u>>>=c&7,c-=c&7;c<32;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",t.mode=se;break}if(t.length=u&65535,u=0,c=0,t.mode=Bn,n===Yt)break e;case Bn:t.mode=_r;case _r:if(b=t.length,b){if(b>o&&(b=o),b>l&&(b=l),b===0)break e;ke.arraySet(r,i,a,b,s),o-=b,a+=b,l-=b,s+=b,t.length-=b;break}t.mode=Le;break;case gr:for(;c<14;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(t.nlen=(u&31)+257,u>>>=5,c-=5,t.ndist=(u&31)+1,u>>>=5,c-=5,t.ncode=(u&15)+4,u>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=se;break}t.have=0,t.mode=br;case br:for(;t.have<t.ncode;){for(;c<3;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}t.lens[ge[t.have++]]=u&7,u>>>=3,c-=3}for(;t.have<19;)t.lens[ge[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,ie={bits:t.lenbits},F=Ut(js,t.lens,0,19,t.lencode,0,t.work,ie),t.lenbits=ie.bits,F){e.msg="invalid code lengths set",t.mode=se;break}t.have=0,t.mode=yr;case yr:for(;t.have<t.nlen+t.ndist;){for(;U=t.lencode[u&(1<<t.lenbits)-1],D=U>>>24,J=U>>>16&255,z=U&65535,!(D<=c);){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(z<16)u>>>=D,c-=D,t.lens[t.have++]=z;else{if(z===16){for(B=D+2;c<B;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(u>>>=D,c-=D,t.have===0){e.msg="invalid bit length repeat",t.mode=se;break}q=t.lens[t.have-1],b=3+(u&3),u>>>=2,c-=2}else if(z===17){for(B=D+3;c<B;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}u>>>=D,c-=D,q=0,b=3+(u&7),u>>>=3,c-=3}else{for(B=D+7;c<B;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}u>>>=D,c-=D,q=0,b=11+(u&127),u>>>=7,c-=7}if(t.have+b>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=se;break}for(;b--;)t.lens[t.have++]=q}}if(t.mode===se)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=se;break}if(t.lenbits=9,ie={bits:t.lenbits},F=Ut(Yi,t.lens,0,t.nlen,t.lencode,0,t.work,ie),t.lenbits=ie.bits,F){e.msg="invalid literal/lengths set",t.mode=se;break}if(t.distbits=6,t.distcode=t.distdyn,ie={bits:t.distbits},F=Ut(er,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,ie),t.distbits=ie.bits,F){e.msg="invalid distances set",t.mode=se;break}if(t.mode=tn,n===Yt)break e;case tn:t.mode=nn;case nn:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,t.hold=u,t.bits=c,Is(e,d),s=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,i=e.input,o=e.avail_in,u=t.hold,c=t.bits,t.mode===Le&&(t.back=-1);break}for(t.back=0;U=t.lencode[u&(1<<t.lenbits)-1],D=U>>>24,J=U>>>16&255,z=U&65535,!(D<=c);){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(J&&(J&240)===0){for(Z=D,j=J,$=z;U=t.lencode[$+((u&(1<<Z+j)-1)>>Z)],D=U>>>24,J=U>>>16&255,z=U&65535,!(Z+D<=c);){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}u>>>=Z,c-=Z,t.back+=Z}if(u>>>=D,c-=D,t.back+=D,t.length=z,J===0){t.mode=kr;break}if(J&32){t.back=-1,t.mode=Le;break}if(J&64){e.msg="invalid literal/length code",t.mode=se;break}t.extra=J&15,t.mode=mr;case mr:if(t.extra){for(B=t.extra;c<B;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=wr;case wr:for(;U=t.distcode[u&(1<<t.distbits)-1],D=U>>>24,J=U>>>16&255,z=U&65535,!(D<=c);){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if((J&240)===0){for(Z=D,j=J,$=z;U=t.distcode[$+((u&(1<<Z+j)-1)>>Z)],D=U>>>24,J=U>>>16&255,z=U&65535,!(Z+D<=c);){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}u>>>=Z,c-=Z,t.back+=Z}if(u>>>=D,c-=D,t.back+=D,J&64){e.msg="invalid distance code",t.mode=se;break}t.offset=z,t.extra=J&15,t.mode=Er;case Er:if(t.extra){for(B=t.extra;c<B;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=se;break}t.mode=Sr;case Sr:if(l===0)break e;if(b=d-l,t.offset>b){if(b=t.offset-b,b>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=se;break}b>t.wnext?(b-=t.wnext,P=t.wsize-b):P=t.wnext-b,b>t.length&&(b=t.length),T=t.window}else T=r,P=s-t.offset,b=t.length;b>l&&(b=l),l-=b,t.length-=b;do r[s++]=T[P++];while(--b);t.length===0&&(t.mode=nn);break;case kr:if(l===0)break e;r[s++]=t.length,l--,t.mode=nn;break;case Fn:if(t.wrap){for(;c<32;){if(o===0)break e;o--,u|=i[a++]<<c,c+=8}if(d-=l,e.total_out+=d,t.total+=d,d&&(e.adler=t.check=t.flags?je(t.check,r,d,s-d):Mn(t.check,r,d,s-d)),d=l,(t.flags?u:Ar(u))!==t.check){e.msg="incorrect data check",t.mode=se;break}u=0,c=0}t.mode=Or;case Or:if(t.wrap&&t.flags){for(;c<32;){if(o===0)break e;o--,u+=i[a++]<<c,c+=8}if(u!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=se;break}u=0,c=0}t.mode=xr;case xr:F=Ms;break e;case se:F=nr;break e;case Cr:return ir;case Fs:default:return Ce}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,t.hold=u,t.bits=c,(t.wsize||d!==e.avail_out&&t.mode<se&&(t.mode<Fn||n!==tr))&&Ir(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,t.total+=d,t.wrap&&d&&(e.adler=t.check=t.flags?je(t.check,r,d,e.next_out-d):Mn(t.check,r,d,e.next_out-d)),e.data_type=t.bits+(t.last?64:0)+(t.mode===Le?128:0)+(t.mode===tn||t.mode===Bn?256:0),(h===0&&d===0||n===tr)&&F===ot&&(F=Bs),F}function Vs(e){if(!e||!e.state)return Ce;var n=e.state;return n.window&&(n.window=null),e.state=null,ot}function Qs(e,n){var t;return!e||!e.state||(t=e.state,(t.wrap&2)===0)?Ce:(t.head=n,n.done=!1,ot)}function Xs(e,n){var t=n.length,i,r,a;return!e||!e.state||(i=e.state,i.wrap!==0&&i.mode!==en)?Ce:i.mode===en&&(r=1,r=Mn(r,n,t,0),r!==i.check)?nr:(a=Ir(e,n,t,t),a?(i.mode=Cr,ir):(i.havedict=1,ot))}Te.inflateReset=Tr,Te.inflateReset2=Pr,Te.inflateResetKeep=Rr,Te.inflateInit=Gs,Te.inflateInit2=Dr,Te.inflate=Ks,Te.inflateEnd=Vs,Te.inflateGetHeader=Qs,Te.inflateSetDictionary=Xs,Te.inflateInfo="pako inflate (from Nodeca project)";var jr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function Js(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Ys=Js,yt=Te,Mt=Ee,rn=at,ce=jr,$n=Cn,eo=Zi,to=Ys,Ur=Object.prototype.toString;function ut(e){if(!(this instanceof ut))return new ut(e);this.options=Mt.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(e&&e.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15)===0&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eo,this.strm.avail_out=0;var t=yt.inflateInit2(this.strm,n.windowBits);if(t!==ce.Z_OK)throw new Error($n[t]);if(this.header=new to,yt.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=rn.string2buf(n.dictionary):Ur.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=yt.inflateSetDictionary(this.strm,n.dictionary),t!==ce.Z_OK)))throw new Error($n[t])}ut.prototype.push=function(e,n){var t=this.strm,i=this.options.chunkSize,r=this.options.dictionary,a,s,o,l,u,c=!1;if(this.ended)return!1;s=n===~~n?n:n===!0?ce.Z_FINISH:ce.Z_NO_FLUSH,typeof e=="string"?t.input=rn.binstring2buf(e):Ur.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Mt.Buf8(i),t.next_out=0,t.avail_out=i),a=yt.inflate(t,ce.Z_NO_FLUSH),a===ce.Z_NEED_DICT&&r&&(a=yt.inflateSetDictionary(this.strm,r)),a===ce.Z_BUF_ERROR&&c===!0&&(a=ce.Z_OK,c=!1),a!==ce.Z_STREAM_END&&a!==ce.Z_OK)return this.onEnd(a),this.ended=!0,!1;t.next_out&&(t.avail_out===0||a===ce.Z_STREAM_END||t.avail_in===0&&(s===ce.Z_FINISH||s===ce.Z_SYNC_FLUSH))&&(this.options.to==="string"?(o=rn.utf8border(t.output,t.next_out),l=t.next_out-o,u=rn.buf2string(t.output,o),t.next_out=l,t.avail_out=i-l,l&&Mt.arraySet(t.output,t.output,o,l,0),this.onData(u)):this.onData(Mt.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(c=!0)}while((t.avail_in>0||t.avail_out===0)&&a!==ce.Z_STREAM_END);return a===ce.Z_STREAM_END&&(s=ce.Z_FINISH),s===ce.Z_FINISH?(a=yt.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===ce.Z_OK):(s===ce.Z_SYNC_FLUSH&&(this.onEnd(ce.Z_OK),t.avail_out=0),!0)},ut.prototype.onData=function(e){this.chunks.push(e)},ut.prototype.onEnd=function(e){e===ce.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Mt.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Zn(e,n){var t=new ut(n);if(t.push(e,!0),t.err)throw t.msg||$n[t.err];return t.result}function no(e,n){return n=n||{},n.raw=!0,Zn(e,n)}jt.Inflate=ut,jt.inflate=Zn,jt.inflateRaw=no,jt.ungzip=Zn;var io=Ee.assign,ro=Pe,ao=jt,so=jr,Mr={};io(Mr,ro,ao,so);var oo=Mr;function uo(e){var n=L.exports.Base64.atob(e),t=n.split("").map(function(r){return r.charCodeAt(0)}),i=new Uint8Array(t);return JSON.parse(oo.inflate(i,{to:"string"}))}function Lr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function co(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Lr(Object(t),!0).forEach(function(i){f(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Lr(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function Br(){return new Set}function Lt(e){return new Set(e)}function Fr(e){var n=[];return e&&e.forEach(function(t){return n.push(t)}),n}function fo(){return new Map}function an(e){return Object.keys(e)}function Be(e){return Object.values(e)}function mt(e){return Object.entries(e)}function sn(e,n){var t=co({},e);if(n){var i=an(e);i.forEach(function(r){n[r]!==void 0&&(t[r]=n[r])})}return t}function ct(e,n,t){return String.prototype.startsWith.call(e,n,t)}function lo(e,n,t){return String.prototype.endsWith.call(e,n,t)}function qn(e,n){return qn=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},qn(e,n)}function ho(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function on(e,n,t){return ho()?on=Reflect.construct:on=function(r,a,s){var o=[null];o.push.apply(o,a);var l=Function.bind.apply(r,o),u=new l;return s&&qn(u,s.prototype),u},on.apply(null,arguments)}function vo(e){if(Array.isArray(e))return A(e)}function po(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _o(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gn(e){return vo(e)||po(e)||k(e)||_o()}var Fe=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;C(this,e),f(this,"enabled",void 0),f(this,"prefix",void 0),this.enabled=n;for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.prefix=i}return _(e,[{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"log",value:function(){if(this.enabled)try{for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=console).log.apply(t,["[PubSub]"].concat(Gn(this.prefix),r))}catch{}}},{key:"error",value:function(){if(this.enabled)try{for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=console).error.apply(t,["[PubSub]"].concat(Gn(this.prefix),r))}catch{}}},{key:"create",value:function(t){return on(e,[this.enabled].concat(Gn(this.prefix),[t]))}}]),e}(),go=function(){function e(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new Fe;C(this,e),f(this,"connection",void 0),f(this,"logger",void 0),f(this,"timeout",void 0),f(this,"timeoutMs",void 0),this.connection=n,this.logger=t}return _(e,[{key:"start",value:function(t,i){this.timeoutMs=t,this.log("Started: interval:".concat(i,", timeout:").concat(t)),this.reset()}},{key:"handle",value:function(t){this.reset(),ct(t,te.PING)&&(this.log("Ping Pong"),this.connection.send(te.PONG))}},{key:"stop",value:function(){this.clearTimeout()}},{key:"reset",value:function(){var t=this;this.clearTimeout(),this.timeout=setTimeout(function(){t.log("Timeout"),t.connection.onTimeout()},this.timeoutMs)}},{key:"clearTimeout",value:function(n){function t(){return n.apply(this,arguments)}return t.toString=function(){return n.toString()},t}(function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)})},{key:"log",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).log.apply(t,["[Ping/Pong]"].concat(r))}}]),e}(),bo=1,yo=function(){function e(n,t,i,r,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:new Fe;C(this,e),f(this,"subscriptions",void 0),f(this,"socket",void 0),f(this,"defaultOptions",void 0),f(this,"logger",void 0),f(this,"closedByError",void 0),f(this,"alive",void 0),f(this,"welcomeTimeout",void 0),f(this,"welcomRequestTimeout",void 0),f(this,"options",void 0),f(this,"pingPong",void 0),f(this,"welcomeReceived",void 0),f(this,"sessionId",void 0),f(this,"sessionOffset",void 0),f(this,"sessionOptions",void 0),f(this,"timeoutMs",void 0),f(this,"intervalMs",void 0),this.subscriptions=n,this.socket=t,this.defaultOptions=i,this.logger=s,this.alive=!0,this.sessionId=r,this.sessionOffset=a,this.welcomeReceived=!1,this.options=i,this.setWelcomeTimeout(),this.log("Created: options:",this.options);var o=this.logger.create("[Connection("+this.socket.id()+")]");this.pingPong=new go(this,o)}return _(e,[{key:"getOptions",value:function(){return this.options}},{key:"getSessionId",value:function(){return this.sessionId}},{key:"getSessionOffset",value:function(){return this.sessionOffset}},{key:"getSessionOptions",value:function(){return this.sessionOptions}},{key:"getTimeoutMs",value:function(){return this.timeoutMs}},{key:"getIntervalMs",value:function(){return this.intervalMs}},{key:"send",value:function(t){this.socket.send(t)}},{key:"onTimeout",value:function(){this.log("Timeout"),this.terminateByError(I.KEEPALIVE_TIMEOUT)}},{key:"onPacket",value:function(t){try{if(this.alive)if(ct(t,te.OPEN)){var i=JSON.parse(t.substring(1));return this.clearWelcomeTimeout(),this.onConnectionOpen(i),de.OK}else{if(!this.welcomeReceived){this.terminateByError(I.WELCOME_EXPECTED);return}if(this.pingPong.handle(t),ct(t,te.PING)&&t.length>1){var r=JSON.parse(t.substring(1)),a=M(r,1),s=a[0];return s}if(ct(t,te.MESSAGE)){var o=t.slice(1,2),l=JSON.parse(t.substring(2));this.onSubscriptionMessage(o,l)}if(ct(t,te.PRESENCE)){var u=t.slice(1,2);if(u===pe.REGISTERED){var c=JSON.parse(t.substring(2)),h=M(c,3),d=h[0],b=h[1],P=h[2];this.setOffset(d)&&this.subscriptions.onRegistered(b,P)}}}}catch{this.terminateByError(I.CORRUPTED_PACKET)}}},{key:"onClose",value:function(){this.alive&&(this.terminateByError(I.CONNECTION_CLOSED),this.log("Connection close"))}},{key:"onError",value:function(t){this.alive&&(this.terminateByError(t),this.log("Connection error"))}},{key:"subscribe",value:function(t,i){this.log("Subscribe: channel:".concat(t,", position:").concat(i));var r=te.MESSAGE+K.SUBSCRIBE;this.alive&&(i?this.send("".concat(r,'["').concat(t,'", "').concat(i,'"]')):this.send("".concat(r,'["').concat(t,'"]')))}},{key:"unsubscribe",value:function(t){this.log("Unsubscribe: channel:".concat(t)),this.send("".concat(te.MESSAGE).concat(K.UNSUBSCRIBE,'["').concat(t,'"]'))}},{key:"register",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.log("Register: capabilities:".concat(t,", activities:"),i);var r=te.PRESENCE+pe.REGISTER;if(this.alive){var a=JSON.stringify(t),s=JSON.stringify(i);this.send("".concat(r,"[").concat(a,",").concat(s,"]"))}}},{key:"close",value:function(t,i){this.terminate(!1,t,i)}},{key:"terminateByError",value:function(t){this.terminate(this.welcomeReceived,Y(t),t)}},{key:"terminate",value:function(t,i,r){this.alive&&(this.log("Closing..."),this.alive=!1,this.closedByError=r,this.pingPong.stop(),this.clearWelcomeTimeout(),t&&this.welcomeReceived&&this.subscriptions.onDetach(),this.socket&&(i&&this.send("1"),this.socket.close()),this.log("Closed"))}},{key:"onConnectionOpen",value:function(t){var i=M(t,4),r=i[0],a=i[1],s=i[2],o=i[3];if(!this.welcomeReceived)this.welcomeReceived=!0,this.log("Connected"),this.log("SessionId:",r),this.sessionId!==r&&(this.sessionId=r,this.sessionOffset=0),this.handshake(r,a,s,o),this.subscriptions.onAttach(this);else if(this.sessionId===r)this.handshake(r,a,s,o),this.subscriptions.onUpdate(o);else{this.terminateByError(I.WELCOME_INCONSISTENT);return}}},{key:"handshake",value:function(t,i,r,a){this.updateSessionOptions(a),this.restartPingPong(i,r)&&this.send("0"+JSON.stringify([t,i,r]))}},{key:"onSubscriptionMessage",value:function(t,i){var r=i[0],a=i[1],s=String(i[2]);if(this.setOffset(r)){if(t===K.SUBSCRIBED&&this.subscriptions.onSubscribed(a,s),t===K.UNSUBSCRIBED){var o=Number(i[2]);this.subscriptions.onUnsubscribed(a,o)}if(t===K.MESSAGE){var l=i[4]!==bo?i[3]:uo(i[3]);this.subscriptions.onMessage(a,s,l)}t===K.POSITION&&this.subscriptions.onPosition(a,s)}}},{key:"setOffset",value:function(t){return this.sessionOffset===void 0||t-this.sessionOffset!==1?(this.terminateByError(I.CORRUPTED_OFFSET),!1):(this.sendAck(t),this.sessionOffset=t,!0)}},{key:"sendAck",value:function(t){this.log("Ack: offset:".concat(t)),this.send("".concat(te.MESSAGE).concat(K.ACK,"[").concat(t,"]"))}},{key:"setWelcomeTimeout",value:function(){var t=this;this.options.welcomeRequestDelayMs<=0?this.send("".concat(te.OPEN)):this.welcomRequestTimeout=setTimeout(function(){t.welcomRequestTimeout=void 0,t.alive&&!t.welcomeReceived&&t.send("".concat(te.OPEN))},this.options.welcomeRequestDelayMs),this.welcomeTimeout=setTimeout(function(){t.alive&&!t.welcomeReceived&&(t.log("Welcome Timeout"),t.terminateByError(I.WELCOME_TIMEOUT))},this.options.welcomeMaxDelayMs)}},{key:"clearWelcomeTimeout",value:function(){this.welcomRequestTimeout&&(clearTimeout(this.welcomRequestTimeout),this.welcomRequestTimeout=void 0),this.welcomeTimeout&&(clearTimeout(this.welcomeTimeout),this.welcomeTimeout=void 0)}},{key:"restartPingPong",value:function(t,i){var r=1e3*t,a=1e3*i;return this.intervalMs!==r||this.timeoutMs!==a?(this.intervalMs=1e3*t,this.timeoutMs=1e3*i,this.log("Ping Interval",t,"Seconds"),this.log("Ping Timeout:",i,"Seconds"),this.pingPong.start(this.timeoutMs,this.intervalMs),!0):!1}},{key:"updateSessionOptions",value:function(t){this.sessionOptions=t,this.options=sn(this.defaultOptions,t)}},{key:"log",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).log.apply(t,["[Connection("+this.socket.id()+")]"].concat(r))}}]),e}(),mo=function(){function e(n,t,i){C(this,e),f(this,"subscriptions",void 0),f(this,"options",void 0),f(this,"logger",void 0),this.subscriptions=n,this.options=t,this.logger=i}return _(e,[{key:"create",value:function(t,i,r){return new yo(this.subscriptions,t,this.options,i,r,this.logger)}}]),e}(),wo=function(){function e(n,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Fe;C(this,e),f(this,"listener",void 0),f(this,"errorHandler",void 0),f(this,"logger",void 0),this.listener=n,this.errorHandler=t,this.logger=i}return _(e,[{key:"onConnect",value:function(t){var i=this;this.safe(function(){i.listener.onConnect&&i.listener.onConnect(t)},"Connected")}},{key:"onAttach",value:function(){var t=this;this.safe(function(){t.listener.onAttach&&t.listener.onAttach()},"Attached")}},{key:"onDetach",value:function(){var t=this;this.safe(function(){t.listener.onDetach&&t.listener.onDetach()},"Detached")}},{key:"onFailure",value:function(t){var i=this;this.safe(function(){i.listener.onFailure&&i.listener.onFailure(t)},"Failed",t)}},{key:"safe",value:function(t){for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];this.log.apply(this,r);try{t()}catch(s){this.error(s),this.logError("Listener callback failure: ",s)}}},{key:"error",value:function(t){try{this.errorHandler&&this.errorHandler.error(t)}catch{}}},{key:"log",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).log.apply(t,["[Listener]"].concat(r))}},{key:"logError",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).error.apply(t,["[Listener]"].concat(r))}}]),e}(),Eo=function(){function e(n,t){C(this,e),f(this,"factory",void 0),f(this,"logger",void 0),this.factory=n,this.logger=t||new Fe}return _(e,[{key:"create",value:function(t,i,r){var a=this,s=!0,o=this.factory(i);o.onopen=function(){s&&(a.log(t,"Open"),r.onOpen(t))},o.onmessage=function(u){s&&(a.log(t,"Received:",u.data),r.onMessage(t,u.data))},o.onclose=function(u){s&&(s=!1,a.log(t,"Closed:",u),r.onClose(t,u.code))},o.onerror=function(u){s&&(s=!1,a.log(t,"Failed:",u),r.onError(t))};var l=this;return{id:function(){return t},send:function(c){if(s)try{l.log(t,"Send:",c),o.send(c)}catch(h){l.log(t,"Send error",h),s=!1,l.closeSocket(t,o),r.onClose(t)}},close:function(){s&&(l.log(t,"Close"),s=!1,l.closeSocket(t,o),r.onClose(t))}}}},{key:"closeSocket",value:function(t,i){try{i.close()}catch(r){this.log(t,"Close error (ignored)",r)}}},{key:"log",value:function(t){for(var i,r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];(i=this.logger).log.apply(i,["[Socket("+t+")]"].concat(a))}}]),e}();function zr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,i)}return t}function Bt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?zr(Object(t),!0).forEach(function(i){f(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zr(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function So(e,n,t){switch(e){case 401:return Bt({code:e,message:"user not authenticated",channel:n},t);case 403:return Bt({code:e,message:"channel access forbidden",channel:n},t);case 404:return Bt({code:e,message:"channel not found",channel:n},t);case 430:return Bt({code:e,message:"too many open channels",channel:n},t);default:return Bt({code:e,message:"unknown problem",channel:n},t)}}var Hr=function(){function e(){C(this,e),f(this,"capabilities",Br()),f(this,"activities",fo())}return _(e,[{key:"add",value:function(t){var i=this;t&&(t.capabilities&&t.capabilities.forEach(function(r){return i.capabilities.add(r)}),t.activities&&mt(t.activities).forEach(function(r){var a=M(r,2),s=a[0],o=a[1],l=i.getActivitySet(s);o&&o.forEach(function(u){return l.add(u)})}))}},{key:"get",value:function(){return{capabilities:this.convertCapabilities(),activities:this.convertActivities()}}},{key:"convertCapabilities",value:function(){if(this.capabilities.size!==0)return Fr(this.capabilities)}},{key:"convertActivities",value:function(){if(this.activities.size!==0){var t={};return this.activities.forEach(function(i,r){i&&(t[r]=Fr(i))}),t}}},{key:"getActivitySet",value:function(t){var i=this.activities.get(t);return i===void 0&&(i=Br(),this.activities.set(t,i)),i}}]),e}(),ko=function(){function e(n,t,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Fe;C(this,e),f(this,"subscriberId",void 0),f(this,"subscriber",void 0),f(this,"errorHandler",void 0),f(this,"logger",void 0),this.subscriberId=n,this.subscriber=t,this.errorHandler=i,this.logger=r}return _(e,[{key:"onAttach",value:function(t){var i=this;this.safe(function(){i.subscriber.onAttach&&i.subscriber.onAttach(t)},"Attached: continuation:".concat(t))}},{key:"onDetach",value:function(){var t=this;this.safe(function(){t.subscriber.onDetach&&t.subscriber.onDetach()},"Detached")}},{key:"onMessage",value:function(t){var i=this;this.safe(function(){i.subscriber.onMessage&&i.subscriber.onMessage(t)},"Message: ",t),this.log("Message: ",t)}},{key:"onComplete",value:function(){var t=this;this.safe(function(){t.subscriber.onComplete&&t.subscriber.onComplete()},"Completed")}},{key:"onFailure",value:function(t){var i=this;this.safe(function(){i.subscriber.onFailure&&i.subscriber.onFailure(t)},"Failed",t)}},{key:"safe",value:function(t){for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];this.log.apply(this,r);try{t()}catch(s){this.error(s),this.logError("Subscriber callback failure: ",s)}}},{key:"error",value:function(t){try{this.errorHandler&&this.errorHandler.error(t)}catch{}}},{key:"log",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).log.apply(t,["[Subscriber(".concat(this.subscriberId,")]")].concat(r))}},{key:"logError",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).error.apply(t,["[Subscriber(".concat(this.subscriberId,")]")].concat(r))}}]),e}(),Oo=function(){function e(n,t,i){C(this,e),f(this,"callbackErrorHandler",void 0),f(this,"logger",void 0),f(this,"attached",!1),f(this,"position",void 0),f(this,"subscribers",{}),this.callbackErrorHandler=t,this.logger=i?i.create("[Subscription(".concat(n,")]")):new Fe}return _(e,[{key:"addSubscriber",value:function(t,i,r){this.log("Added: subscriberId:".concat(t,", categories:"),r);var a=new ko(t,i,this.callbackErrorHandler,this.logger);this.subscribers[t]={subscriber:a,categories:r},this.attached&&a.onAttach(!1)}},{key:"updateSubscriber",value:function(t,i){this.log("Updated: subscriberId:".concat(t,", categories:").concat(i)),this.subscribers[t]&&(this.subscribers[t].categories=i)}},{key:"removeSubscriber",value:function(t){this.log("Removed: subscriberId:".concat(t)),delete this.subscribers[t]}},{key:"setPosition",value:function(t){this.position=t}},{key:"getPosition",value:function(){return this.position}},{key:"isEmpty",value:function(){return Object.keys(this.subscribers).length===0}},{key:"isAttached",value:function(){return this.attached}},{key:"getCategories",value:function(){var t=new Hr;return Be(this.subscribers).forEach(function(i){t.add(i.categories)}),t.get()}},{key:"onAttach",value:function(t){var i=!t||this.position===t;this.attached=!0,this.position=t||this.position,Be(this.subscribers).forEach(function(r){r.subscriber.onAttach(i)})}},{key:"onDetach",value:function(){this.attached=!1,Be(this.subscribers).forEach(function(t){t.subscriber.onDetach()})}},{key:"onComplete",value:function(){this.attached=!1,Be(this.subscribers).forEach(function(t){t.subscriber.onComplete()})}},{key:"onFailure",value:function(t){this.attached=!1,Be(this.subscribers).forEach(function(i){i.subscriber.onFailure(t)})}},{key:"onMessage",value:function(t,i){this.setPosition(t),Be(this.subscribers).forEach(function(r){r.subscriber.onMessage(i)})}},{key:"log",value:function(){var t;(t=this.logger).log.apply(t,arguments)}}]),e}(),xo=function(){function e(n,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;C(this,e),f(this,"listener",void 0),f(this,"defaultOptions",void 0),f(this,"capabilities",void 0),f(this,"callbackErrorHandler",void 0),f(this,"alive",!0),f(this,"connection",void 0),f(this,"sessionId",void 0),f(this,"subscriptions",{}),f(this,"waitingSubscribes",{}),f(this,"pendingSubscribes",{}),f(this,"pendingUnsubscribes",{}),f(this,"options",void 0),f(this,"subscriberIdGenerator",0),f(this,"numberOfReconnections",0),f(this,"categories",{}),f(this,"confirmedCategories",void 0),f(this,"sentCategories",void 0),f(this,"registerTimeout",void 0),f(this,"logger",void 0),this.listener=n,this.defaultOptions=t,this.capabilities=i,this.callbackErrorHandler=r,this.confirmedCategories={},this.sentCategories={},this.options=t,this.logger=a?a.create("[Subscriptions]"):new Fe,this.log("Created: options:",this.options)}return _(e,[{key:"close",value:function(){this.log("Closed"),this.alive=!1,this.cancelRegisterTimeout()}},{key:"isAttached",value:function(){return this.connection!==void 0}},{key:"isAuthenticated",value:function(){return this.isAttached()&&this.sessionId!==void 0&&ct(this.sessionId,"A")}},{key:"getOptions",value:function(){return this.options}},{key:"getSessionId",value:function(){return this.sessionId}},{key:"getChannels",value:function(){return Object.keys(this.subscriptions)}},{key:"getSubscription",value:function(t){return this.subscriptions[t]}},{key:"getWaitingSubscribes",value:function(){return Object.keys(this.waitingSubscribes)}},{key:"getPendingSubscribes",value:function(){return Object.keys(this.pendingSubscribes)}},{key:"getPendingUnsubscribes",value:function(){return Object.keys(this.pendingUnsubscribes)}},{key:"getNumberOfReconnections",value:function(){return this.numberOfReconnections}},{key:"subscribe",value:function(t,i,r){var a=this,s=(++this.subscriberIdGenerator).toString();return this.log("Subscriber added: channel:".concat(t)),this.addSubscriber(t,s,i,r),{close:function(){a.log("Subscriber removed: channel:".concat(t)),a.removeSubscriber(t,s)},update:function(l){a.updateSubscriber(t,s,l)}}}},{key:"addCapabilities",value:function(t){var i=this,r=(++this.subscriberIdGenerator).toString();return this.log("Capabilities Added: id:".concat(t)),this.categories[r]={capabilities:t},this.checkCategories(),{close:function(){i.log("Capabilities Removed: id:".concat(t)),delete i.categories[r],i.checkCategories()}}}},{key:"addActivities",value:function(t){var i=this,r=(++this.subscriberIdGenerator).toString();return this.log("Activities Added: id:".concat(t)),this.categories[r]={activities:t},this.checkCategories(),{close:function(){i.log("Activities Removed: id:".concat(t)),delete i.categories[r],i.checkCategories()}}}},{key:"onAttach",value:function(t){if(this.alive){this.connection=t;var i=this.connection.getSessionId();this.log("Attached: sessionId:".concat(i)),this.options=sn(this.defaultOptions,this.connection.getSessionOptions()),this.sessionId===void 0?(this.sessionId=i,this.listener.onConnect(),this.checkCategories(),this.attachToNewSession()):(this.numberOfReconnections++,this.listener.onAttach(),this.sessionId===i?(this.attachToExistentSession(),this.categoriesEquals(this.confirmedCategories,this.sentCategories)||this.pushCategories()):(this.sessionId=i,this.attachToNewSession(),this.pushCategories()))}}},{key:"onUpdate",value:function(t){this.alive&&(this.options=sn(this.defaultOptions,t))}},{key:"onDetach",value:function(){this.alive&&(this.log("Detached:"),this.listener.onDetach(),this.connection=void 0,this.getSubscriptions().forEach(function(t){return t.onDetach()}))}},{key:"onMessage",value:function(t,i,r){if(this.alive){this.log("Message: channel:".concat(t,", position:").concat(i,", message:"),r);var a=this.subscriptions[t];a&&a.onMessage(i,r)}}},{key:"onPosition",value:function(t,i){if(this.alive){this.log("Position: channelPattern:".concat(t,", position:").concat(i));var r=t,a="",s=t.indexOf("$");s>-1&&(r=t.substring(0,s),a=t.substring(s+1)),mt(this.subscriptions).forEach(function(o){var l=M(o,2),u=l[0],c=l[1];ct(u,r)&&lo(u,a)&&c.setPosition(i)})}}},{key:"onSubscribed",value:function(t,i){if(this.alive){this.log("Subscribed: channel:".concat(t,", position:").concat(i));var r=this.subscriptions[t];r&&(delete this.pendingSubscribes[t],r.onAttach(i)),this.pushkWaitingSubscribes()}}},{key:"onUnsubscribed",value:function(t,i){var r=this;if(this.alive){this.log("Unsubscribed: channel:".concat(t,", reason:").concat(i)),delete this.pendingUnsubscribes[t];var a=this.subscriptions[t];if(a)if(i>=500)a.onDetach(),this.sendError(I.CHANNEL_FAILURE),setTimeout(function(){r.sendSubscribe(t,a.getPosition())},this.options.subscribeRetryTimoutMs);else if(i>=400){var s=So(i,t,{sessionId:this.sessionId});a.onFailure(s),this.removeSubscription(t)}else i===204&&(a.onComplete(),this.removeSubscription(t))}}},{key:"onRegistered",value:function(t,i){this.alive&&(this.confirmedCategories={capabilities:t,activities:i},this.log("Registered: categories:",this.confirmedCategories),this.categoriesEquals(this.confirmedCategories,this.sentCategories)&&this.cancelRegisterTimeout())}},{key:"addSubscriber",value:function(t,i,r,a){this.connection||this.log("Connection is not ready yet"),this.hasSubscription(t)||(this.createSubscription(t),this.sendSubscribe(t)),this.subscriptions[t].addSubscriber(i,r,a),this.categoriesNonEmpty(a)&&this.checkCategories()}},{key:"updateSubscriber",value:function(t,i,r){var a=this.subscriptions[t];a&&(a.updateSubscriber(i,r),this.checkCategoriesNow())}},{key:"removeSubscriber",value:function(t,i){var r=this.subscriptions[t];r&&(r.removeSubscriber(i),r.isEmpty()&&(this.removeSubscription(t),this.sendUnsubscribe(t),this.pushkWaitingSubscribes(),this.checkCategoriesNow()))}},{key:"getCategories",value:function(){var t=new Hr;return t.add({capabilities:this.capabilities}),Be(this.categories).forEach(function(i){return t.add(i)}),Be(this.subscriptions).forEach(function(i){t.add(i.getCategories())}),t.get()}},{key:"attachToExistentSession",value:function(){var t=this;mt(this.subscriptions).forEach(function(i){var r=M(i,2),a=r[0],s=r[1];t.pendingSubscribes[a]?t.sendSubscribe(a,s.getPosition()):s.onAttach()})}},{key:"attachToNewSession",value:function(){var t=this;this.waitingSubscribes={},this.pendingSubscribes={},this.pendingUnsubscribes={},mt(this.subscriptions).forEach(function(i){var r=M(i,2),a=r[0],s=r[1];return t.sendSubscribe(a,s.getPosition())})}},{key:"getSubscriptions",value:function(){return Be(this.subscriptions)}},{key:"sendError",value:function(t){this.connection&&t!==I.CHANNEL_FAILURE&&this.closeConnection(!1,t)}},{key:"sendSubscribe",value:function(t,i){var r=this,a=Date.now();if(!this.pendingSubscribes.hasOwnProperty(t)&&Object.keys(this.pendingSubscribes).length>=this.options.maxPendingRequests){this.waitingSubscribes[t]=a;return}this.log("Subscribe: channel:".concat(t,", position:").concat(i)),delete this.waitingSubscribes[t],this.pendingSubscribes[t]=a,this.connection&&(i?this.connection.subscribe(t,i):this.connection.subscribe(t),setTimeout(function(){r.alive&&r.pendingSubscribes[t]===a&&r.sendError(I.SUBSCRIBE_TIMEOUT)},this.options.responseMaxDelayMs))}},{key:"sendUnsubscribe",value:function(t){var i=this;this.log("Unsubscribe: channel:".concat(t));var r=Date.now();this.pendingUnsubscribes[t]=r,this.connection&&(this.connection.unsubscribe(t),setTimeout(function(){i.alive&&i.pendingUnsubscribes[t]===r&&(delete i.pendingUnsubscribes[t],i.sendError(I.UNSUBSCRIBE_TIMEOUT))},this.options.responseMaxDelayMs))}},{key:"sendRegister",value:function(t){this.log("Register: categories:",t),this.connection&&(this.sentCategories=t,this.connection.register(t.capabilities,t.activities),this.startRegisterTimeout())}},{key:"startRegisterTimeout",value:function(){var t=this;this.cancelRegisterTimeout(),this.registerTimeout=setTimeout(function(){t.alive&&!t.categoriesEquals(t.confirmedCategories,t.sentCategories)&&t.sendError(I.REGISTER_TIMEOUT)},this.options.responseMaxDelayMs)}},{key:"cancelRegisterTimeout",value:function(){this.registerTimeout&&(clearTimeout(this.registerTimeout),this.registerTimeout=void 0)}},{key:"pushkWaitingSubscribes",value:function(){if(Object.keys(this.waitingSubscribes).length>0){var t=Object.keys(this.waitingSubscribes)[0];this.sendSubscribe(t,this.subscriptions[t].getPosition())}}},{key:"hasSubscription",value:function(t){return this.subscriptions[t]!==void 0}},{key:"createSubscription",value:function(t){delete this.pendingUnsubscribes[t],this.subscriptions[t]=new Oo(t,this.callbackErrorHandler,this.logger)}},{key:"removeSubscription",value:function(t){delete this.subscriptions[t],delete this.waitingSubscribes[t],delete this.pendingSubscribes[t],this.checkCategoriesNow()}},{key:"pushCategories",value:function(){this.sentCategories=void 0,this.sendRegister(this.getCategories())}},{key:"checkCategories",value:function(){var t=this;this.options.registerDelayMs?setTimeout(function(){return t.checkCategoriesNow()},this.options.registerDelayMs):this.checkCategoriesNow()}},{key:"checkCategoriesNow",value:function(){var t=this.getCategories();this.categoriesEquals(this.sentCategories,t)||this.sendRegister(t)}},{key:"categoriesNonEmpty",value:function(t){return t&&(t.capabilities&&t.capabilities.length>0||t.activities&&an(t.activities).length>0)}},{key:"categoriesEquals",value:function(t,i){return this.capabilitiesEquals(t,i)&&this.activitiesEquals(t,i)}},{key:"capabilitiesEquals",value:function(t,i){var r=t&&t.capabilities?t.capabilities:[],a=i&&i.capabilities?i.capabilities:[],s=Lt(r),o=Lt(a);return this.setEquals(s,o)}},{key:"activitiesEquals",value:function(t,i){var r=this,a=t&&t.activities?t.activities:{},s=i&&i.activities?i.activities:{},o=an(a),l=an(s);if(o.length!==l.length)return!1;var u=!0,c=Lt(l);return mt(a).forEach(function(h){var d=M(h,2),b=d[0],P=d[1];if(c.has(b)||(u=!1),u){var T=Lt(P),U=Lt(a[b]);r.setEquals(T,U)||(u=!1)}}),u}},{key:"setEquals",value:function(t,i){if(t.size!==i.size)return!1;var r=!0;return t.forEach(function(a){i.has(a)||(r=!1)}),r}},{key:"closeConnection",value:function(t,i){this.connection&&(this.connection.close(t,i),this.connection=void 0)}},{key:"log",value:function(){var t;(t=this.logger).log.apply(t,arguments)}}]),e}(),ze={},Ft={},$r={},ft={};Object.defineProperty(ft,"__esModule",{value:!0});function Co(e,n){if(!e)throw new Error(n?"assertion failed: "+n:"assertion failed")}ft.assert=Co;function Ao(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof ne<"u")return ne;var e;try{e=new Function("return this")()}catch{}return e}ft.getGlobal=Ao,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n=ft,t=function(){function s(){this.length=0,this._max=1e3,this._first=0}return s.prototype.push=function(o,l){return this[this.length++]=o,this[this.length++]=l,this.length<this._max},s.prototype.flush=function(){for(;this._first<this.length;){var o=this[this._first],l=this[this._first+1];this[this._first]=this[this._first+1]=void 0,this._first+=2,o(l)}this.length=0,this._first=0},s.prototype.empty=function(){return this._first===this.length},s}(),i=function(){function s(o){this._ring=[new t],this._current=this._ring[0],this._pool=o}return s.prototype.enqueue=function(o,l){this._current||(this._current=this._pool.pop(),this._current||(this._current=new t),this._ring.push(this._current)),this._current.push(o,l)||(this._current=void 0)},s.prototype.flush=function(){for(;this._ring[0].flush(),this._ring.length!==1;)this._pool.push(this._ring.shift());this._current=this._ring[0]},s.prototype.empty=function(){return this._ring.length===1&&this._ring[0].empty()},s}();function r(s){typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}var a=function(){function s(){var o=this;this._pool=[],this._mainRing=new i(this._pool),this._idleRing=new i(this._pool),this._flushing=!1,this._scheduled=!1,this._scheduler=void 0,this._flusher=function(){return o._scheduledFlush()}}return s.prototype.setScheduler=function(o){n.assert(o==null||typeof o=="function"),this._scheduler=o},s.prototype.enqueue=function(o,l){!this._flushing&&!this._scheduled&&this._schedule(),this._mainRing.enqueue(o,l)},s.prototype.enqueueIdle=function(o,l){!this._flushing&&!this._scheduled&&this._schedule(),this._idleRing.enqueue(o,l)},s.prototype.flush=function(){n.assert(!this._flushing,"cannot recursively flush"),this._flushing=!0;try{for(;this._mainRing.flush(),!this._idleRing.empty();){var o=this._mainRing;this._mainRing=this._idleRing,this._idleRing=o}}finally{this._flushing=!1,(!this._mainRing.empty()||!this._idleRing.empty())&&!this._scheduled&&this._schedule()}},s.prototype._schedule=function(){n.assert(!this._scheduled);var o=this._scheduler||r;o(this._flusher),this._scheduled=!0},s.prototype._scheduledFlush=function(){this._scheduled=!1,this.flush()},s}();e.Async=a,e.async=new a,e.default=e.async}($r);var Ue={},un={},Ro=ne&&ne.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},e(t,i)};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(un,"__esModule",{value:!0});var To=function(e){Ro(n,e);function n(t,i){var r=this.constructor,a=e.call(this,i)||this,s=!1;if(a.constructor!==r&&(Object.setPrototypeOf&&Object.setPrototypeOf(a,r.prototype),s=!0),"stack"in a||(s=!0),a.name=t,s)if(Error.captureStackTrace)Error.captureStackTrace(a,r);else{var o=new Error(i);o.name=t;try{throw o}catch(l){a.stack=l.stack||String(l)}}return a}return n}(Error);un.default=To;var Wn=ne&&ne.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},e(t,i)};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Ue,"__esModule",{value:!0});var Po=un,Do=ft,Kn=function(e){Wn(n,e);function n(t,i,r){var a=e.call(this,t,i+": "+r)||this;a.reason=r;var s=a.reason&&X(a.reason)==="object"&&a.reason.stack;return typeof s!="string"&&(s=String(a.reason)),a.stack=a.name+": "+s,a}return n}(Po.default);Ue.BaseUnhandledRejection=Kn;var Zr=function(e){Wn(n,e);function n(t,i){var r=e.call(this,"UnhandledRejection","unhandled rejection",t)||this;return r.trace=i,r}return n}(Kn);Ue.UnhandledRejection=Zr;var qr=function(e){Wn(n,e);function n(t){var i=e.call(this,"PossiblyUnhandledRejection","possibly unhandled rejection",t.reason())||this;return i.promise=t,i}return n}(Kn);Ue.PossiblyUnhandledRejection=qr;function Gr(e,n,t){var i=new PromiseRejectionEvent(e,{cancelable:!0,promise:!0,reason:n});Object.defineProperty(i,"promise",{value:t});var r=Do.getGlobal();return!!(r.dispatchEvent&&!r.dispatchEvent(i))}function No(e,n){var t=new Zr(e,n);throw t}Ue.defaultUnhandledRejectionHandler=No;function Io(e){var n=!0;if(typeof g<"u"&&typeof g.emit=="function"?g.emit("unhandledRejection",e.reason(),e)&&(n=!1):typeof PromiseRejectionEvent=="function"&&Gr("unhandledrejection",e.reason(),e)&&(n=!1),n){var t=new qr(e);console.warn(t.stack)}}Ue.defaultPossiblyUnhandledRejectionHandler=Io;function jo(e){typeof g<"u"&&typeof g.emit=="function"?g.emit("rejectionHandled",e):typeof PromiseRejectionEvent=="function"&&Gr("rejectionhandled",e.reason(),e)}Ue.defaultPossiblyUnhandledRejectionHandledHandler=jo;var cn={},Vn={};Object.defineProperty(Vn,"__esModule",{value:!0});var Uo=typeof Error.captureStackTrace=="function",Mo=function(){function e(n){n===void 0&&(n=e),Uo?Error.captureStackTrace(this,n):this.stack=`dummy
<no trace>`}return e.prototype.inspect=function(){var n=this.stack.split(`
`);return n.shift(),n.join(`
`)},e}();Vn.default=Mo,Object.defineProperty(cn,"__esModule",{value:!0});var Lo=Vn,Bo=function(){function e(n){n===void 0&&(n=e),this.stack=new Lo.default(n)}return e.prototype.setSource=function(n){n.sources?(this.sources=n.sources.concat(n.stack),this.sources.length>e.traceLimit&&(this.sources=this.sources.slice(0,e.traceLimit))):this.sources=[n.stack]},e.prototype.inspect=function(){var n=this.stack.inspect();if(this.sources)for(var t=this.sources.length-1;t>=0;t--)n+=`
  from previous:
`+this.sources[t].inspect();return n},e.traceLimit=10,e}();cn.default=Bo,Object.defineProperty(Ft,"__esModule",{value:!0});var wt=$r,Qn=Ue,Xn=cn,He=ft,ue,Jn=!1,Wr;(function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"})(Wr||(Wr={}));var Kr;(function(e){e[e.RejectionHandled=1]="RejectionHandled",e[e.UnhandledRejectionNotified=2]="UnhandledRejectionNotified"})(Kr||(Kr={}));function fn(e,n){}function ln(){}var hn={error:void 0};function Vu(e){return e}var Fo=new Xn.default,$e,zo=0,zt=function(){function e(n){var t=this;if(this._id=zo++,this._state=0,this._result=void 0,this._handlers=void 0,this._flags=0,this._trace=void 0,ue&&ue(this,"construct"),Jn&&(this._trace=new Xn.default(e),$e&&this._setSource($e)),n!==fn){if(typeof n!="function")throw new TypeError("Promise resolver is not a function");var i=!1;try{n(function(r){i||(i=!0,t._resolve(r))},function(r){i||(i=!0,t._reject(r))})}catch(r){i||(i=!0,this._reject(r))}}}return e.prototype.then=function(n,t){if(ue&&ue(this,"then("+X(n)+", "+X(t)+")"),this._state===1&&typeof n!="function"||this._state===2&&typeof t!="function")return this;var i=new(Object.getPrototypeOf(this)).constructor(fn);return i._setSource(this),this._enqueue(n,t,i,void 0),i},e.prototype.done=function(n,t){if(ue&&ue(this,"done("+X(n)+", "+X(t)+")"),!(this._state===1&&typeof n!="function")){var i=Fo;Jn&&(i=new Xn.default,this._trace&&i.setSource(this._trace)),this._enqueue(n,t,void 0,i)}},e.prototype.catch=function(){if(arguments.length===1){var n=arguments[0];return this.then(void 0,n)}else{var t=arguments[0],i=arguments[1];return this.then(void 0,function(r){var a=!1;if(typeof t=="function")t.prototype instanceof Error||t===Error?a=r instanceof t:a=t(r);else if(Array.isArray(t))for(var s=0,o=t;s<o.length;s++){var l=o[s];if(r instanceof l){a=!0;break}}else throw new TypeError("invalid predicate to .catch(), got "+X(t));return a?i(r):e.reject(r)})}},e.prototype.finally=function(n){var t=this,i=function(){return n(t)};return this.then(i,i).return(this)},e.prototype.isFulfilled=function(){return this._state===1},e.prototype.isRejected=function(){return this._state===2},e.prototype.isPending=function(){return this._state===0},e.prototype.value=function(){if(!this.isFulfilled())throw new Error("Promise is not fulfilled");return this._result},e.prototype.reason=function(){if(!this.isRejected())throw new Error("Promise is not rejected");return this._result},e.prototype.suppressUnhandledRejections=function(){this._setRejectionHandled()},e.prototype.inspect=function(){return this.toString()},e.prototype.toString=function(){var n;switch(this._state){case 0:n="pending";break;case 1:n="fulfilled";break;case 2:n="rejected";break;default:n="unknown"}return"[Promise "+this._id+": "+n+"]"},e.prototype.delay=function(n){return this.then(function(t){return new e(function(i){setTimeout(function(){return i(t)},n)})})},e.prototype.return=function(n){return n===void 0?this.then(ln):this.then(function(){return n})},e.prototype.throw=function(n){return this.then(function(){return e.reject(n)})},e.prototype._setSource=function(n){!this._trace||!n._trace||this._trace.setSource(n._trace)},e.prototype._resolve=function(n){if(He.assert(this._state===0),!n){this._fulfill(n);return}if(this===n){this._reject(new TypeError("cannot resolve Promise to self"));return}if(n instanceof e){n._setSource(this),n._setRejectionHandled(),n._state===0?this._followPromise(n):n._state===1?this._fulfill(n._result):this._reject(n._result);return}if(X(n)==="object"||typeof n=="function"){var t=this._tryGetThen(n);if(t===hn){this._reject(hn.error);return}if(typeof t=="function"){this._followThenable(n,t);return}}this._fulfill(n)},e.prototype._tryGetThen=function(n){try{var t=n.then;return t}catch(i){return hn.error=i,hn}},e.prototype._fulfill=function(n){He.assert(this._state===0),ue&&ue(this,"_fulfill("+X(n)+")"),this._state=1,this._result=n,this._flush()},e.prototype._reject=function(n){if(He.assert(this._state===0),ue&&ue(this,"_reject("+n+")"),this._state=2,this._result=n,this._trace&&this._result instanceof Error&&!this._result.trace){var t=this._trace;this._result.trace=t;var i=this._result.stack;i&&Object.defineProperty(this._result,"stack",{enumerable:!1,get:function(){return i+`
  from Promise at:
`+t.inspect()}})}this._flags&1||wt.default.enqueueIdle(e._unhandledRejectionChecker,this),this._flush()},e.prototype._setRejectionHandled=function(){!(this._flags&1)&&this._flags&2&&wt.default.enqueue(e._onPossiblyUnhandledRejectionHandledHandler,this),this._flags|=1,ue&&ue(this,"rejectionHandled")},e.prototype._doCheckUnhandledRejection=function(){!(this._flags&1)&&!(this._flags&2)&&(this._flags|=2,wt.default.enqueue(e._onPossiblyUnhandledRejectionHandler,this))},e.prototype._followPromise=function(n){He.assert(this._state===0),ue&&ue(this,"_follow([Promise "+n._id+"])"),n._enqueue(void 0,void 0,this,void 0)},e.prototype._followThenable=function(n,t){var i=this;He.assert(this._state===0),ue&&ue(this,"_follow([Thenable])");var r=!1;try{t.call(n,function(a){r||(r=!0,i._resolve(a))},function(a){r||(r=!0,i._reject(a))})}catch(a){r||(r=!0,this._reject(a))}},e.prototype._enqueue=function(n,t,i,r){var a={promise:this,onFulfilled:n,onRejected:t,slave:i,done:r};if(this._state!==0)wt.default.enqueue(e._unwrapper,a);else if(!this._handlers)this._handlers=[a];else{var s=this._handlers.length;this._handlers[s]=a}this._setRejectionHandled()},e.prototype._flush=function(){if(!!this._handlers){var n=0,t=this._handlers,i=t.length;for(this._handlers=void 0;n<i;)wt.default.enqueue(e._unwrapper,t[n++])}},e.prototype._unwrap=function(n){var t=this._state===1?n.onFulfilled:n.onRejected;if(n.done){if(ue&&ue(this,"_unwrap()"),typeof t!="function"){this._state===2&&e._onUnhandledRejectionHandler(this._result,n.done);return}He.assert(!$e),$e=this;try{var i=t(this._result);if(i){var r=i instanceof e?i:e.resolve(i);r.done()}$e=void 0}catch(s){$e=void 0,e._onUnhandledRejectionHandler(s,n.done)}return}var a=n.slave;if(ue&&ue(this,"_unwrap("+a._id+")"),typeof t=="function"){He.assert(!$e),$e=a;try{a._resolve(t(this._result))}catch(s){a._reject(s)}$e=void 0}else this._state===1?a._fulfill(this._result):a._reject(this._result)},e.resolve=function(n){var t=new e(fn);return t._resolve(n),t},e.reject=function(n){var t=new e(fn);return t._reject(n),t},e.all=function(n){return new e(function(t,i){if(He.assert(Array.isArray(n),"thenables must be an Array"),n.length===0){t([]);return}for(var r=new Array(n.length),a=n.length,s=0;s<n.length;s++)o(n[s],s);function o(l,u){var c=l instanceof e?l:e.resolve(l);c.done(function(h){r[u]=h,a--,a===0&&t(r)},function(h){return i(h)})}})},e.race=function(n){return new e(function(t,i){He.assert(Array.isArray(n),"thenables must be an Array");for(var r=0,a=n;r<a.length;r++){var s=a[r],o=s instanceof e?s:e.resolve(s);e.resolve(o).done(t,i)}})},e.defer=function(){var n,t,i=new e(function(r,a){n=r,t=a});return{promise:i,reject:t,resolve:n}},e.delay=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(arguments[1]===void 0){var i=arguments[0];return new e(function(r){setTimeout(r,i)})}return e.resolve(arguments[0]).delay(arguments[1])},e.onUnhandledRejection=function(n){if(n===!0)e._onUnhandledRejectionHandler=Qn.defaultUnhandledRejectionHandler;else if(n===!1)e._onUnhandledRejectionHandler=ln;else{if(typeof n!="function")throw new TypeError("invalid handler: boolean or function expected");e._onUnhandledRejectionHandler=n}},e.onPossiblyUnhandledRejection=function(n){if(n===!0)e._onPossiblyUnhandledRejectionHandler=Qn.defaultPossiblyUnhandledRejectionHandler;else if(n===!1)e._onPossiblyUnhandledRejectionHandler=ln;else{if(typeof n!="function")throw new TypeError("invalid handler: boolean or function expected");e._onPossiblyUnhandledRejectionHandler=n}},e.onPossiblyUnhandledRejectionHandled=function(n){if(n===!0)e._onPossiblyUnhandledRejectionHandledHandler=Qn.defaultPossiblyUnhandledRejectionHandledHandler;else if(n===!1)e._onPossiblyUnhandledRejectionHandledHandler=ln;else{if(typeof n!="function")throw new TypeError("invalid handler: boolean or function expected");e._onPossiblyUnhandledRejectionHandledHandler=n}},e.setLongTraces=function(n){Jn=n},e.setTracer=function(n){typeof n=="function"?ue=n:ue=void 0},e.flush=function(){wt.default.flush()},e._unwrapper=function(n){n.promise._unwrap(n)},e._unhandledRejectionChecker=function(n){n._doCheckUnhandledRejection()},e}();Ft.Promise=zt,zt.onUnhandledRejection(!0),zt.onPossiblyUnhandledRejection(!0),zt.onPossiblyUnhandledRejectionHandled(!0),Ft.default=zt;var Yn={};Object.defineProperty(Yn,"__esModule",{value:!0});var Vr=Ft,Ho=ft;function $o(e){e===void 0&&(e=!1);var n=Ho.getGlobal();return n?e||typeof n.Promise!="function"?(n.Promise=Vr.Promise,!0):n.Promise instanceof Vr.Promise:!1}Yn.default=$o,Object.defineProperty(ze,"__esModule",{value:!0});var Qr=Ft,Zo=ze.default=Qr.default;ze.Promise=Qr.Promise;var qo=cn;ze.Trace=qo.default;var Xr=Ue;ze.UnhandledRejection=Xr.UnhandledRejection,ze.PossiblyUnhandledRejection=Xr.PossiblyUnhandledRejection;var Go=Ue;ze.UnhandledRejectionError=Go.UnhandledRejection;var Wo=Yn;ze.polyfill=Wo.default;var Ko=un;ze.BaseError=Ko.default;var Vo=function(){function e(){C(this,e)}return _(e,[{key:"schedule",value:function(t){return new Zo(function(i){setTimeout(i,t)})}}]),e}(),Jr={},lt={};Object.defineProperty(lt,"__esModule",{value:!0}),lt.BaseEvent=void 0;var Qo=function(){function e(){}return e.prototype.attach=function(n,t){return this._attach(n,t,!1)},e.prototype.once=function(n,t){return this._attach(n,t,!0)},e.prototype._attach=function(n,t,i){var r=this,a,s,o,l;if(typeof n=="function")s=n,l=function(){return r.detach(s)};else if(!t&&typeof n.post=="function")o=n,l=function(){return r.detach(o)};else{if(X(n)!=="object"||n===void 0)throw new Error("Expect a function or object as first argument");if(typeof t!="function")throw new Error("Expect a function as second argument");a=n,s=t,l=function(){return r.detach(a,s)}}return this._listeners?this._listeners=this._listeners.slice():this._listeners=[],this._listeners.push({deleted:!1,boundTo:a,handler:s,event:o,once:i}),l},e.prototype.detach=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this._detach.apply(this,n)},e.prototype._detach=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(!(!this._listeners||this._listeners.length===0)){var i,r,a;n.length>=1&&(typeof n[0]=="function"?r=n[0]:n.length===1&&typeof n[0].post=="function"?a=n[0]:i=n[0]),n.length>=2&&(r=n[1]),this._listeners=this._listeners.filter(function(s){return(typeof r>"u"||s.handler===r)&&(typeof a>"u"||s.event===a)&&(typeof i>"u"||s.boundTo===i)?(s.deleted=!0,!1):!0}),this._listeners.length===0&&delete this._listeners}},e.prototype.post=function(n){throw new Error("abstract")},e.prototype.listenerCount=function(){return this._listeners?this._listeners.length:0},e.prototype._call=function(n,t){!this._listeners||n.deleted||(n.once&&(n.deleted=!0,this._listeners=this._listeners.filter(function(i){return i!==n}),this._listeners.length===0&&delete this._listeners),n.event?n.event.post.apply(n.event,t):n.handler&&n.handler.apply(X(n.boundTo)==="object"?n.boundTo:this,t))},e}();lt.BaseEvent=Qo;var Ae={},ei=ne&&ne.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},e(t,i)};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.ErrorSyncEvent=Ae.VoidSyncEvent=Ae.SyncEvent=void 0;var Xo=lt,ti=function(e){ei(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t._recursion=0,t}return Object.defineProperty(n.prototype,"evtListenersChanged",{get:function(){return this._listenersChanged||(this._listenersChanged=new Yr),this._listenersChanged},enumerable:!1,configurable:!0}),n.prototype.post=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(!(!this._listeners||this._listeners.length===0)){if(this._recursion++,typeof n.MAX_RECURSION_DEPTH=="number"&&Number.isInteger(n.MAX_RECURSION_DEPTH)&&n.MAX_RECURSION_DEPTH>0&&this._recursion>n.MAX_RECURSION_DEPTH)throw new Error("event fired recursively");for(var r=this._listeners,a=0;a<r.length;++a){var s=r[a];this._call(s,t)}this._recursion--}},n.prototype._attach=function(t,i,r){var a,s,o,l,u=(s=(a=this._listeners)===null||a===void 0?void 0:a.length)!==null&&s!==void 0?s:0,c=e.prototype._attach.call(this,t,i,r);return this.evtListenersChanged&&u!==((l=(o=this._listeners)===null||o===void 0?void 0:o.length)!==null&&l!==void 0?l:0)&&this.evtListenersChanged.post(),c},n.prototype._detach=function(){for(var t,i,r,a,s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];var l=(i=(t=this._listeners)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0,u=e.prototype._detach.apply(this,s);return this.evtListenersChanged&&l!==((a=(r=this._listeners)===null||r===void 0?void 0:r.length)!==null&&a!==void 0?a:0)&&this.evtListenersChanged.post(),u},n.MAX_RECURSION_DEPTH=10,n}(Xo.BaseEvent);Ae.SyncEvent=ti;var Yr=function(e){ei(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(){e.prototype.post.call(this,void 0)},n}(ti);Ae.VoidSyncEvent=Yr;var Jo=function(e){ei(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(t){if(this.listenerCount()===0)throw new Error("error event posted while no listeners attached. Error: "+t.message);e.prototype.post.call(this,t)},n}(ti);Ae.ErrorSyncEvent=Jo;var Ze={},Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});var ea=Ae,Yo=function(){function e(){this.evtFilled=new ea.SyncEvent,this.evtDrained=new ea.SyncEvent,this._queue=[],this._flushing=!1}return e.global=function(){return e._instance||e.resetGlobal(),e._instance},e.resetGlobal=function(){e._instance=new e},e.prototype.empty=function(){return this._queue.length===0},e.prototype.add=function(n){this._queue.push(n),this._queue.length===1&&!this._flushing&&this.evtFilled.post(this)},e.prototype.flushOnce=function(){var n=this._queue.length===0,t=this._flushing;this._flushing=!0;try{var i=this._queue;this._queue=[];for(var r=0;r<i.length;++r)i[r]()}finally{this._flushing=t,!n&&!t&&this._queue.length===0&&this.evtDrained.post(this)}},e.prototype.flush=function(n){n===void 0&&(n=10);var t=this._queue.length===0,i=this._flushing;this._flushing=!0;try{for(var r=0;this._queue.length>0;){if(typeof n=="number"&&r>=n)throw this._queue=[],new Error("unable to flush the queue due to recursively added event. Clearing queue now");this.flushOnce(),++r}}finally{this._flushing=i,!t&&!i&&this._queue.length===0&&this.evtDrained.post(this)}},e}();Ht.default=Yo;var ni=ne&&ne.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},e(t,i)};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.ErrorQueuedEvent=Ze.VoidQueuedEvent=Ze.QueuedEvent=void 0;var eu=lt,tu=Ht,nu=Ae,ii=function(e){ni(n,e);function n(t){t===void 0&&(t={});var i=e.call(this)||this;return i._queued=!1,i.options=t,typeof t.condensed=="boolean"?i._condensed=t.condensed:i._condensed=!1,X(t.queue)==="object"&&t.queue!==null&&(i._queue=t.queue),i}return Object.defineProperty(n.prototype,"evtListenersChanged",{get:function(){return this._listenersChanged||(this._listenersChanged=new nu.VoidSyncEvent),this._listenersChanged},enumerable:!1,configurable:!0}),n.prototype.post=function(){for(var t=this,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if(!(!this._listeners||this._listeners.length===0)){var a=this._queue?this._queue:tu.default.global();if(this._condensed){if(this._queuedData=i,this._queuedListeners=this._listeners,this._queued)return;this._queued=!0,a.add(function(){t._queued=!1;for(var o=t._queuedData,l=t._queuedListeners,u=0;u<l.length;++u){var c=l[u];t._call(c,o)}})}else{var s=this._listeners;a.add(function(){for(var o=0;o<s.length;++o){var l=s[o];t._call(l,i)}})}}},n.prototype._attach=function(t,i,r){var a,s,o,l,u=(s=(a=this._listeners)===null||a===void 0?void 0:a.length)!==null&&s!==void 0?s:0,c=e.prototype._attach.call(this,t,i,r);return this.evtListenersChanged&&u!==((l=(o=this._listeners)===null||o===void 0?void 0:o.length)!==null&&l!==void 0?l:0)&&this.evtListenersChanged.post(),c},n.prototype._detach=function(){for(var t,i,r,a,s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];var l=(i=(t=this._listeners)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0,u=e.prototype._detach.apply(this,s);return this.evtListenersChanged&&l!==((a=(r=this._listeners)===null||r===void 0?void 0:r.length)!==null&&a!==void 0?a:0)&&this.evtListenersChanged.post(),u},n}(eu.BaseEvent);Ze.QueuedEvent=ii;var iu=function(e){ni(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(){e.prototype.post.call(this,void 0)},n}(ii);Ze.VoidQueuedEvent=iu;var ru=function(e){ni(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(t){if(!this._listeners||this._listeners.length===0)throw new Error("error event posted while no listeners attached. Error: "+t.message);e.prototype.post.call(this,t)},n}(ii);Ze.ErrorQueuedEvent=ru;var qe={},ri=ne&&ne.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},e(t,i)};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(qe,"__esModule",{value:!0}),qe.ErrorAsyncEvent=qe.VoidAsyncEvent=qe.AsyncEvent=void 0;var au=lt,su=Ae,ai=function(e){ri(n,e);function n(t){t===void 0&&(t={});var i=e.call(this)||this;return i._queued=!1,i.options=t,typeof t.condensed=="boolean"?i._condensed=t.condensed:i._condensed=!1,i}return Object.defineProperty(n.prototype,"evtListenersChanged",{get:function(){return this._listenersChanged||(this._listenersChanged=new su.VoidSyncEvent),this._listenersChanged},enumerable:!1,configurable:!0}),n.defaultScheduler=function(t){typeof window<"u"?setTimeout(t,0):setImmediate(t)},n.setScheduler=function(t){n._scheduler=t},n.prototype.post=function(){for(var t=this,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if(!(!this._listeners||this._listeners.length===0))if(this._condensed){if(this._queuedData=i,this._queuedListeners=this._listeners,this._queued)return;this._queued=!0,n._scheduler(function(){t._queued=!1;for(var s=t._queuedData,o=t._queuedListeners,l=0;l<o.length;++l){var u=o[l];t._call(u,s)}})}else{var a=this._listeners;n._scheduler(function(){for(var s=0;s<a.length;++s){var o=a[s];t._call(o,i)}})}},n.prototype._call=function(t,i){t.event&&t.event instanceof n?t.event._postDirect(i):e.prototype._call.call(this,t,i)},n.prototype._postDirect=function(t){if(!(!this._listeners||this._listeners.length===0))for(var i=this._listeners,r=0;r<i.length;++r){var a=i[r];this._call(a,t)}},n.prototype._attach=function(t,i,r){var a,s,o,l,u=(s=(a=this._listeners)===null||a===void 0?void 0:a.length)!==null&&s!==void 0?s:0,c=e.prototype._attach.call(this,t,i,r);return this.evtListenersChanged&&u!==((l=(o=this._listeners)===null||o===void 0?void 0:o.length)!==null&&l!==void 0?l:0)&&this.evtListenersChanged.post(),c},n.prototype._detach=function(){for(var t,i,r,a,s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];var l=(i=(t=this._listeners)===null||t===void 0?void 0:t.length)!==null&&i!==void 0?i:0,u=e.prototype._detach.apply(this,s);return this.evtListenersChanged&&l!==((a=(r=this._listeners)===null||r===void 0?void 0:r.length)!==null&&a!==void 0?a:0)&&this.evtListenersChanged.post(),u},n._scheduler=n.defaultScheduler,n}(au.BaseEvent);qe.AsyncEvent=ai;var ou=function(e){ri(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(){e.prototype.post.call(this,void 0)},n}(ai);qe.VoidAsyncEvent=ou;var uu=function(e){ri(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.post=function(t){if(this.listenerCount()===0)throw new Error("error event posted while no listeners attached. Error: "+t.message);e.prototype.post.call(this,t)},n}(ai);qe.ErrorAsyncEvent=uu;var ta={},dn={};Object.defineProperty(dn,"__esModule",{value:!0}),dn.shallowEquals=void 0;function cu(e,n){if(e===n)return!0;if(X(e)!==X(n))return!1;switch(X(e)){case"boolean":case"number":case"string":case"function":case"symbol":case"undefined":return!1;case"object":if(e===null||n===null)return!1;if(Array.isArray(e)||Array.isArray(n)){if(!Array.isArray(e)||!Array.isArray(n)||e.length!==n.length)return!1;for(var t=0;t<e.length;++t)if(e[t]!==n[t])return!1;return!0}var i=[],r=[];for(var a in e)e.hasOwnProperty(a)&&i.push(a);for(var s in n)n.hasOwnProperty(s)&&r.push(s);if(i.sort(),r.sort(),i.join(",")!==r.join(","))return!1;for(var t=0;t<i.length;++t)if(e[i[t]]!==n[i[t]])return!1;return!0;default:return!1}}dn.shallowEquals=cu,function(e){var n=ne&&ne.__extends||function(){var c=function(d,b){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,T){P.__proto__=T}||function(P,T){for(var U in T)T.hasOwnProperty(U)&&(P[U]=T[U])},c(d,b)};return function(h,d){c(h,d);function b(){this.constructor=h}h.prototype=d===null?Object.create(d):(b.prototype=d.prototype,new b)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorAnyEvent=e.VoidAnyEvent=e.AnyEvent=e.EventType=void 0;var t=dn,i=Ae,r=qe,a=Ze,s;(function(c){c[c.Sync=0]="Sync",c[c.Async=1]="Async",c[c.Queued=2]="Queued"})(s=e.EventType||(e.EventType={}));var o=function(){function c(h){this._events=[],h&&h.monitorAttach&&(this.evtFirstAttached=new l,this.evtLastDetached=new l)}return Object.defineProperty(c.prototype,"evtListenersChanged",{get:function(){return this._listenersChanged||(this._listenersChanged=new i.VoidSyncEvent),this._listenersChanged},enumerable:!1,configurable:!0}),c.prototype.attach=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];var b=s.Sync;h.length>0&&typeof h[0]=="number"&&(b=h.shift());var P=this,T,U,D;return typeof h[0]=="function"||h[0]&&X(h[0])==="object"&&typeof h[0].post=="function"?(typeof h[0]=="function"?T=h[0]:D=h[0],U=h[1]):(P=h[0],T=h[1],U=h[2]),this._attach(b,P,T,D,U,!1)},c.prototype.once=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];var b=s.Sync;h.length>0&&typeof h[0]=="number"&&(b=h.shift());var P=this,T,U,D;return typeof h[0]=="function"||h[0]&&X(h[0])==="object"&&typeof h[0].post=="function"?(typeof h[0]=="function"?T=h[0]:D=h[0],U=h[1]):(P=h[0],T=h[1],U=h[2]),this._attach(b,P,T,D,U,!0)},c.prototype._attach=function(h,d,b,P,T,U){var D=this,J=this.evtFirstAttached?this.listenerCount():0,z;switch(h){case s.Sync:{for(var Z=0,j=this._events;Z<j.length;Z++){var $=j[Z];$ instanceof i.SyncEvent&&(z=$)}z||(z=new i.SyncEvent,this._events.push(z))}break;case s.Async:{for(var q=0,F=this._events;q<F.length;q++){var $=F[q];$ instanceof r.AsyncEvent&&t.shallowEquals($.options,T)&&(z=$)}z||(z=new r.AsyncEvent(T),this._events.push(z))}break;case s.Queued:{for(var W=0,ie=this._events;W<ie.length;W++){var $=ie[W];$ instanceof a.QueuedEvent&&t.shallowEquals($.options,T)&&(z=$)}z||(z=new a.QueuedEvent(T),this._events.push(z))}break;default:throw new Error("unknown EventType")}var B;return U?P?B=z.once(P):B=z.once(d,b):P?B=z.attach(P):B=z.attach(d,b),this.evtFirstAttached&&J===0&&this.evtFirstAttached.post(),this.evtListenersChanged&&J!==this.listenerCount()&&this.evtListenersChanged.post(),function(){var ge=D.evtLastDetached?D.listenerCount():0;B(),!!D.evtLastDetached&&ge>0&&D.listenerCount()===0&&D.evtLastDetached.post(),D.evtListenersChanged&&ge!==D.listenerCount()&&D.evtListenersChanged.post()}},c.prototype.attachSync=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];return h.unshift(s.Sync),this.attach.apply(this,h)},c.prototype.onceSync=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];return h.unshift(s.Sync),this.once.apply(this,h)},c.prototype.attachAsync=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];return h.unshift(s.Async),this.attach.apply(this,h)},c.prototype.onceAsync=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];return h.unshift(s.Async),this.once.apply(this,h)},c.prototype.attachQueued=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];return h.unshift(s.Queued),this.attach.apply(this,h)},c.prototype.onceQueued=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];return h.unshift(s.Queued),this.once.apply(this,h)},c.prototype.detach=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];for(var b=this.listenerCount(),P=0;P<this._events.length;++P)this._events[P].detach.apply(this._events[P],h);this.evtListenersChanged&&b!==this.listenerCount()&&this.evtListenersChanged.post(),!!this.evtLastDetached&&b>0&&this.listenerCount()===0&&this.evtLastDetached.post()},c.prototype.post=function(h){for(var d=[],b=0;b<this._events.length;++b)d.push(this._events[b]);for(var b=0;b<d.length;++b)d[b].post(h)},c.prototype.listenerCount=function(){for(var h=0,d=0;d<this._events.length;++d)h+=this._events[d].listenerCount();return h},c}();e.AnyEvent=o;var l=function(c){n(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.prototype.post=function(){c.prototype.post.call(this,void 0)},h}(o);e.VoidAnyEvent=l;var u=function(c){n(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.prototype.post=function(d){if(this.listenerCount()===0)throw new Error("error event posted while no listeners attached. Error: "+d.message);c.prototype.post.call(this,d)},h}(o);e.ErrorAnyEvent=u}(ta),function(e){var n=ne&&ne.__createBinding||(Object.create?function(l,u,c,h){h===void 0&&(h=c),Object.defineProperty(l,h,{enumerable:!0,get:function(){return u[c]}})}:function(l,u,c,h){h===void 0&&(h=c),l[h]=u[c]}),t=ne&&ne.__exportStar||function(l,u){for(var c in l)c!=="default"&&!u.hasOwnProperty(c)&&n(u,l,c)};Object.defineProperty(e,"__esModule",{value:!0}),e.flush=e.flushOnce=e.queue=void 0,t(lt,e),t(Ae,e),t(Ze,e),t(qe,e),t(ta,e);var i=Ht,r=Ht;Object.defineProperty(e,"EventQueue",{enumerable:!0,get:function(){return r.default}});function a(){return i.default.global()}e.queue=a;function s(){i.default.global().flushOnce()}e.flushOnce=s;function o(l){l===void 0&&(l=10),i.default.global().flush(l)}e.flush=o}(Jr);var si;(function(e){e.UNAUTHENTICATED=4001})(si||(si={}));var fu=function(){function e(n,t,i,r,a,s,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:new Fe;C(this,e),f(this,"connectionFactory",void 0),f(this,"socketFactory",void 0),f(this,"timer",void 0),f(this,"url",void 0),f(this,"params",void 0),f(this,"defaultOptions",void 0),f(this,"listener",void 0),f(this,"logger",void 0),f(this,"alive",!0),f(this,"socketIdGenerator",0),f(this,"numberOfConnectionAttempts",0),f(this,"options",void 0),f(this,"online",!0),f(this,"quality",de.OFFLINE),f(this,"qualityEvent",new Jr.AsyncEvent),f(this,"socket",void 0),f(this,"connection",void 0),f(this,"sessionId",void 0),f(this,"sessionOffset",void 0),f(this,"previousConnectionError",void 0),this.connectionFactory=n,this.socketFactory=t,this.timer=i,this.url=r,this.params=a,this.defaultOptions=s,this.listener=o,this.logger=l,this.options=s,this.log("Created: options:",this.options)}return _(e,[{key:"getOptions",value:function(){return this.options}},{key:"setOnline",value:function(t){var i=this.online;this.online=t,!t&&i&&this.connection&&(this.closeConnection(I.CLIENT_OFFLINE),this.closeSocket()),!t&&i&&this.socket&&this.closeSocket(),t&&!i&&this.reconnect()}},{key:"getQuality",value:function(){return this.quality}},{key:"addQualityListener",value:function(t){var i=this;return this.qualityEvent.attach(t),{close:function(){i.qualityEvent.detach(t)}}}},{key:"getSocket",value:function(){return this.socket}},{key:"getConnection",value:function(){return this.connection}},{key:"getSessionId",value:function(){return this.sessionId}},{key:"getSessionOffset",value:function(){return this.sessionOffset}},{key:"connect",value:function(){this.assertNotClosed();var t=this.buildUrl();this.numberOfConnectionAttempts++;var i=++this.socketIdGenerator;this.log("#".concat(this.numberOfConnectionAttempts," attempt to open ").concat(t," as socket #").concat(i)),this.socket=this.socketFactory.create(i,t,this)}},{key:"onOpen",value:function(t){this.isValidCallback(t)&&this.socket&&(this.connection=this.connectionFactory.create(this.socket,this.sessionId,this.sessionOffset),this.previousConnectionError=void 0,this.log("WS Connected"))}},{key:"onClose",value:function(t,i){this.isValidCallback(t)&&this.reset(void 0,i)}},{key:"onError",value:function(t){this.isValidCallback(t)&&this.reset(I.CONNECTION_ERROR)}},{key:"onMessage",value:function(t,i){this.isValidCallback(t)&&this.connection&&(this.numberOfConnectionAttempts=0,this.setQuality(this.connection.onPacket(i)))}},{key:"isClosed",value:function(){return!this.alive}},{key:"close",value:function(){this.alive&&(this.alive=!1,this.connection&&(this.connection.close(!0),this.connection=void 0,this.quality=de.OFFLINE),this.closeSocket(),this.log("Closed"))}},{key:"reset",value:function(t,i){this.setQuality(de.OFFLINE),this.closeConnection(t),this.closeSocket(),i===si.UNAUTHENTICATED?this.listener.onFailure(m.UNAUTHENTICATED):this.scheduleReconnection()}},{key:"assertNotClosed",value:function(){if(!this.alive)throw new Error("Transport already cosed")}},{key:"buildUrl",value:function(){var t="".concat(this.url),i=0;return mt(this.params).forEach(function(r){var a=M(r,2),s=a[0],o=a[1];o&&(t+=i++?"&":"?",t+=s+"="+o)}),this.sessionId&&(t+="&sid=".concat(this.sessionId,"&offset=").concat(this.sessionOffset)),this.previousConnectionError&&(t+="&disconnected_by=".concat(this.previousConnectionError)),t}},{key:"isValidCallback",value:function(t){return!!(this.alive&&t===this.socketIdGenerator)}},{key:"scheduleReconnection",value:function(){var t=this,i=this.numberOfConnectionAttempts,r=this.backOffDelayWithJitter(i);this.log("Scheduling #"+(i+1)+" reconnection attempt in "+r+" millisec"),this.timer.schedule(r).then(function(){t.numberOfConnectionAttempts===i&&t.reconnect()})}},{key:"reconnect",value:function(){if(this.alive&&this.socket==null)try{this.connect()}catch{this.scheduleReconnection()}}},{key:"backOffDelayWithJitter",value:function(t){if(!this.online)return this.options.maxReconnectionDelayMs;var i=this.backOffDelay(t);return this.options.reconnectionJitter?Math.max(this.options.initialReconnectionDelayMs,Math.floor(Math.random()*i)):i}},{key:"backOffDelay",value:function(t){if(t<16){var i=this.options.initialReconnectionDelayMs*Math.pow(this.options.reconnectionDelayPowBase,t);return Math.min(i,this.options.maxReconnectionDelayMs)}return this.options.maxReconnectionDelayMs}},{key:"closeConnection",value:function(t){if(this.connection){var i=this.connection.getSessionId();i&&(this.sessionId=i,this.sessionOffset=this.connection.getSessionOffset(),this.options=sn(this.defaultOptions,this.connection.getSessionOptions())),this.previousConnectionError=this.connection.closedByError,t?this.connection.onError(t):this.connection.onClose(),this.connection=void 0}}},{key:"closeSocket",value:function(){if(this.socket){try{this.socket.close()}catch{this.log("Socket close error: socketId="+this.socketIdGenerator)}this.socket=void 0}}},{key:"setQuality",value:function(t){t!=null&&t!==this.quality&&(this.quality=t,this.qualityEvent.post(t))}},{key:"log",value:function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];(t=this.logger).log.apply(t,["[Transport]"].concat(r))}}]),e}(),lu=O,hu=100,du=3e4,oi=1.5,vu=1e4,pu=250,_u=10,gu=1e4,bu=3e4,yu=250,na=function(){function e(n,t,i){var r=this;C(this,e),f(this,"options",void 0),f(this,"WS",void 0),f(this,"id",void 0),f(this,"subscriptions",void 0),f(this,"listener",void 0),f(this,"transport",void 0),f(this,"logger",void 0),this.options=n,this.WS=i,this.id=n.clientId?n.clientId:this.generateId(8);var a=this,s=this.options.uid?""+this.options.uid:void 0;this.logger=new Fe(this.options.debug?this.options.debug:!1),this.listener=new wo(t,this.options.callbackErrorHandler,this.logger);var o=this.subscriptionOptions(),l={onConnect:function(){r.listener.onConnect(r.getOnConnectObject())},onAttach:function(){r.listener.onAttach()},onDetach:function(){r.listener.onDetach()}};this.subscriptions=new xo(l,o,this.options.capabilities,this.options.callbackErrorHandler,this.logger);var u=this.connectionOptions(),c=new mo(this.subscriptions,u,this.logger),h=new Eo(function(D){return a.WS?new a.WS(D):new WebSocket(D)},this.logger),d=this.options.url,b=this.options.token,P={uid:s,token:b,client_type:"web",client_version:e.version,client_id:this.id},T=this.transportOptions(),U={onFailure:function(J){r.listener.onFailure(w(J)),r.close()}};this.transport=new fu(c,h,new Vo,d,P,T,U,this.logger)}return _(e,[{key:"getId",value:function(){return this.id}},{key:"getLogger",value:function(){return this.logger}},{key:"getState",value:function(){return{transport:{isConnected:this.isAttached()}}}},{key:"setOnline",value:function(t){this.transport.setOnline(t)}},{key:"getQuality",value:function(){return this.transport.getQuality()}},{key:"addQualityListener",value:function(t){return this.transport.addQualityListener(t)}},{key:"isAttached",value:function(){return this.subscriptions.isAttached()}},{key:"isAuthenticated",value:function(){return this.subscriptions.isAuthenticated()}},{key:"addCapabilities",value:function(t){return this.subscriptions.addCapabilities(t)}},{key:"addActivities",value:function(t){return this.subscriptions.addActivities(t)}},{key:"isClosed",value:function(){return this.transport.isClosed()}},{key:"close",value:function(){this.subscriptions.close(),this.transport.close()}},{key:"connect",value:function(){if(!this.isWebSocketSupported())return this.listener.onFailure(w(m.TRANSPORT_NOT_SUPPORTED,{type:"websocket"})),this;try{this.transport.connect()}catch(t){this.logger.error("Fatal transport error ",t),this.listener.onFailure(w(m.MALFORMED_URL,{error:t}))}return this}},{key:"subscribe",value:function(t,i,r){return this.subscriptions.subscribe(t,i,r)}},{key:"transportOptions",value:function(){var t={initialReconnectionDelayMs:hu,maxReconnectionDelayMs:du,reconnectionDelayPowBase:oi,reconnectionJitter:!0};return this.options.initialReconnectionDelayMs!==void 0&&(t.initialReconnectionDelayMs=this.options.initialReconnectionDelayMs),this.options.maxReconnectionDelayMs!==void 0&&(t.maxReconnectionDelayMs=this.options.maxReconnectionDelayMs),this.options.reconnectionDelayPowBase!==void 0&&oi>=1.1&&oi<=2&&(t.reconnectionDelayPowBase=this.options.reconnectionDelayPowBase),t}},{key:"connectionOptions",value:function(){var t={welcomeMaxDelayMs:vu,welcomeRequestDelayMs:pu};return this.options.welcomeMaxDelayMs!==void 0&&(t.welcomeMaxDelayMs=this.options.welcomeMaxDelayMs),t}},{key:"subscriptionOptions",value:function(){var t={maxPendingRequests:_u,responseMaxDelayMs:gu,subscribeRetryTimoutMs:bu,registerDelayMs:yu};return this.options.maxPendingRequests!==void 0&&(t.maxPendingRequests=this.options.maxPendingRequests),this.options.responseMaxDelayMs!==void 0&&(t.responseMaxDelayMs=this.options.responseMaxDelayMs),this.options.subscribeRetryTimoutMs!==void 0&&(t.subscribeRetryTimoutMs=this.options.subscribeRetryTimoutMs),this.options.registerDelayMs!==void 0&&(t.registerDelayMs=this.options.registerDelayMs),t}},{key:"getOnConnectObject",value:function(){var t=this;return{getId:function(){return t.getId()},isAttached:function(){return t.isAttached()},isAuthenticated:function(){return t.isAuthenticated()},getQuality:function(){return t.getQuality()},addQualityListener:function(r){return t.addQualityListener(r)},addCapabilities:function(r){return t.addCapabilities(r)},addActivities:function(r){return t.addActivities(r)},subscribe:function(r,a,s){return t.subscribe(r,a,s)}}}},{key:"isWebSocketSupported",value:function(){try{return this.WS!==null||WebSocket!==null}catch{return!1}}},{key:"generateId",value:function(t){for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",a=0;a<t;a++)r+=i.charAt(Math.floor(Math.random()*i.length));return r}}],[{key:"getVersion",value:function(){return e.version}}]),e}();f(na,"version",lu);var mu={connect:function(n,t,i){return new na(n,t,i).connect()}},wu=H(669),Eu=H.n(wu),vn=Eu();function Su(e){const n=e.config,t=e.response;if(e.toString()==="Cancel")return Promise.reject(e);try{n.data=JSON.parse(n.data)}catch{return Promise.reject(e)}if(t&&t.status===403&&t.headers["x-chesscom-csrf-token"]&&n&&!n.data.retry){const i=t.headers["x-chesscom-csrf-token"];return n.data._token=i,n.data.retry=!0,window.context.csrf.token=i,vn(n)}if(t?.status>=400)try{ia(e)}catch{}return Promise.reject(e)}function ia(e){var n,t;if(!window.chesscom.features.includes("client_metrics_error_reporting")||(t=(n=e.config)==null?void 0:n.params)!=null&&t.clientMetricsErrorReport)return;const i={ip:window.context.ip,error:{message:e.message,method:e.config.method,requestHost:window.location.hostname,requestUrl:e.config.url,stack:e.stack,status:e.response.status,type:"HTTP_REQUEST"},user:window.context.user?{countryCode:window.context.user.country.code,id:window.context.user.id,membershipCode:window.context.user.membershipCode,membershipLevel:window.context.user.membershipLevel,timezone:window.context.user.timezone,username:window.context.user.username}:{},userAgent:window.navigator.userAgent};vn.post(`${window.chesscom.clientMetricsDomain}/error-reporting/web`,i,{params:{clientMetricsErrorReport:!0}})}function ra(e){return ku(e)||Ou(e)||xu(e)}function ku(e){return e.startsWith("/service/")||e.includes(".com/service/")}function Ou(e){return e.includes("chessbomb.com")}function xu(e){return/https:\/\/(?!www)([\S]+)chess.com/.test(e)}const Cu=["delete","patch","post","put"];function Au(e){return!e||ra(e.url)||!Cu.includes(e.method)||(e.data instanceof FormData||e.data instanceof URLSearchParams?e.data.append("_token",window.context.csrf.token):e.data=Object.assign({_token:window.context.csrf.token},e.data||{})),e}const Qu={BADGE_COUNT:"data-badge-count",BADGE_TEXT:"data-badge-text",BADGE_TYPE:"data-badge",SEEK_IS_SEEKER:"data-seek-is-seeker",SHAREABLE_GAME_UUID:"data-seek-short-uuid",SHAREABLE_SHARE_LINK:"data-seek-share-link"},Ru={PUZZLE_BATTLE_CHALLENGE_TOASTER:"puzzle-battle-challenge-toaster",PUZZLE_BATTLE_CHALLENGE_USER:"puzzle-battle-challenge-user",HOME_NOTIFICATIONS:"home-sb-notifications",LOGIN_REGISTER_MODAL:"login-register-modal",OFFLINE_CHALLENGE_TOASTER:"offline-challenge-toaster",NAV_ROOT:"sb",SHAREABLE_GAME_URL_MODAL:"shareable-game-url-modal",SHAREABLE_GAME_SHORT_UUID:"shareable-game-short-uuid"},Xu={BADGES:".svelte-badge"},aa=()=>Math.random().toString(36).substring(2,15),Tu=e=>{let n=aa();for(;n.length<e;)n+=aa();return n.substring(0,e)},Pu=()=>{const e=document.getElementById(Ru.NAV_ROOT);return e?Boolean(e.dataset.featureClientRequestId):!1};function Du(e){return Pu()&&(e.headers.common["X-Chesscom-Request-Id"]=Tu(32)),e}const sa=e=>(Object.keys(e).forEach(n=>{const t=e[n];typeof t=="boolean"&&(e[n]=Number(t)),typeof t=="object"&&t!==null&&(e[n]=sa(t))}),e);function Nu(e){return!e||ra(e.url)||typeof e.data=="object"&&(e.data=sa(e.data)),e}var Iu=[Au,Du,Nu];async function oa(){return H.e(48).then(H.bind(H,48))}async function ju(){try{const e=await oa();return Boolean(e.getCurrentHub().getClient())}catch{return!1}}async function Uu(e){if(!await ju())return;(await oa()).configureScope(t=>{Object.keys(e).forEach(i=>{t.setExtra(i,e[i])})})}const Mu=({key:e,value:n})=>{window.chesscom||(window.chesscom={}),window.chesscom[e]||(window.chesscom[e]=n)},ui=()=>{Mu({key:"logData",value:{}})},ua=({key:e,value:n})=>{ui(),window.chesscom.logData[e]=n,Uu({[e]:n})},Ju=({key:e,value:n})=>{ui();const t=window.chesscom.logData[e]||[];Array.isArray(t)?window.chesscom.logData[e]=[...t,n]:window.chesscom.logData[e]=[t,n]},Yu=()=>{ui(),window.chesscom.logData={}};function ca(e){return e.headers&&e.headers["x-chesscom-request-id-cdn"]&&(ua({key:"x-chesscom-request-id-cdn",value:e.headers["x-chesscom-request-id-cdn"]}),ua({key:"x-chesscom-request-id-lb",value:e.headers["x-chesscom-request-id-lb"]})),e}function fa(e,n){var t;if(!n.name)throw new Error("interceptor must be a named function");return(t=e.handlers)==null?void 0:t.find(i=>{var r;return((r=i.fulfilled)==null?void 0:r.name)===n.name})}function Lu(e){Iu.forEach(n=>{fa(e.interceptors.request,n)||e.interceptors.request.use(n)}),fa(e.interceptors.response,ca)||e.interceptors.response.use(ca,Su)}Lu(vn);var Bu=vn;const la=Bu.create({withCredentials:!0});la.interceptors.response.use(e=>e,e=>{var n;if(((n=e?.response)==null?void 0:n.status)>=400)try{ia(e)}catch{}return Promise.reject(e)});var Fu=la;async function ha(e){var n;let t=window.PubSub.options.url[e.service||"base"];const i=e.path instanceof Array?e.path.join("/"):e.path;!t.endsWith("/")&&!i.startsWith("/")&&(t+="/");const r={};["staging","prod"].includes("staging")||(r.uid=(n=window.context.user)==null?void 0:n.uuid),e.params&&Object.assign(r,e.params);const a={};return e.requestId&&(a["x-chesscom-request-id-client"]=e.requestId),e.clientId&&(a["x-chesscom-play-client"]=e.clientId),e.headers&&Object.assign(a,e.headers),Fu({url:/^http[s]?:/.test(i)?i:`${t}${i}`,data:e.data,method:e.method||"post",params:r,headers:a,withCredentials:!0})}async function zu(e){return ha({method:"get",...e})}var Hu=Object.defineProperty,$u=(e,n,t)=>n in e?Hu(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Zu=(e,n,t)=>($u(e,typeof n!="symbol"?n+"":n,t),t);class qu{constructor(){Zu(this,"subscriptions",[])}on(n,t){this.subscriptions.push({eventName:n,handler:t})}off(n,t){this.subscriptions=this.subscriptions.filter(i=>i.eventName!==n||i.handler!==t)}emit(n,t){this.subscriptions.filter(i=>i.eventName===n).forEach(i=>i.handler(t))}}const _e={CONNECT:"connect",DISCONNECT:"disconnect",FAILURE:"failure",MESSAGE:"message",RECONNECT:"reconnect",SUBSCRIBE:"subscribe",SUBSCRIBE_FAIL:"subscribe_fail",UNSUBSCRIBE:"unsubscribe",ERROR:"error"};var da,va;const pa=window,fe=pa.PubSub,_a=pa.context,Gu=(da=_a?.user)==null?void 0:da.uuid;if(fe&&fe.options&&!((va=window.Config)!=null&&va.cypress)){const e=new qu;fe.client=mu.connect({debug:!1,uid:Gu,url:fe.options.url.pubsub},{onAttach:()=>{e.emit(_e.RECONNECT)},onConnect:()=>{e.emit(_e.CONNECT)},onDetach:()=>{e.emit(_e.DISCONNECT)},onFailure:i=>{e.emit(_e.FAILURE,{failure:i})}});const n=fe.client.transport,t=n.onError;n.onError=function(...i){t.apply(n,i),e.emit(_e.ERROR)},fe.subscribe=function(r,a={}){let s=!0;const l=Object.assign({onAttach:u=>{const c={channel:r,isContinuation:u,isInitial:s};e.emit(_e.SUBSCRIBE,c),e.emit(`${_e.SUBSCRIBE}:${r}`,c),s=!1},onComplete:()=>{e.emit(_e.UNSUBSCRIBE,{channel:r}),e.emit(`${_e.UNSUBSCRIBE}:${r}`,{channel:r})},onDetach:()=>{e.emit(_e.UNSUBSCRIBE,{channel:r}),e.emit(`${_e.UNSUBSCRIBE}:${r}`,{channel:r})},onFailure:u=>{const c={channel:r,failure:u};e.emit(_e.SUBSCRIBE_FAIL,c),e.emit(`${_e.SUBSCRIBE_FAIL}:${r}`,c)},onMessage:u=>{const c={channel:r,message:u};e.emit(_e.MESSAGE,c),e.emit(`${_e.MESSAGE}:${r}`,c)}},a);try{return fe.client.subscribe(r,l)}catch(u){throw e.emit(_e.ERROR),u}},fe.getState=function(){return fe.client.getState()},fe.isAttached=()=>fe.client.isAttached(),fe.on=(...i)=>e.on(...i),fe.off=(...i)=>e.off(...i),window.addEventListener("pagehide",()=>{fe.client.close()}),window.addEventListener("online",()=>{fe.client.setOnline(!0)}),window.addEventListener("offline",()=>{fe.client.setOnline(!1)})}fe&&fe.options&&(fe.fetch=zu,fe.publish=ha)})()})();
